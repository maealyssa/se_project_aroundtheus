!function(){"use strict";var e={960:function(e,t,s){e.exports=s.p+"190142da37235e3079a8.jpg"},291:function(e,t,s){e.exports=s.p+"9aed7cb3f54c0faa1f9f.jpg"},822:function(e,t,s){e.exports=s.p+"0fb96793ab89da938a7d.jpg"},328:function(e,t,s){e.exports=s.p+"395d21149564d1293c88.jpg"},705:function(e,t,s){e.exports=s.p+"a22751dd8a0e22ceb5f6.jpg"},561:function(e,t,s){e.exports=s.p+"0df918d480d675e4708e.jpg"}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.m=e,s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.b=document.baseURI||self.location.href,function(){new URL(s(291),s.b),new URL(s(705),s.b),new URL(s(822),s.b),new URL(s(328),s.b),new URL(s(960),s.b),new URL(s(561),s.b);const e={cardsList:".cards__list",cardTemplate:"#card-template",previewPopup:"#image-modal",editFormPopup:"#edit-modal",addFormPopup:"#add-modal",profileTitle:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar",formModalContainer:".modal__container",imageModalContainer:".modal__container-image",changeAvatarPopup:"#change-avatar-modal",confirmDeleteModal:"#confirm-delete-modal"};var t=class{constructor(e,t,s,r,i,n){this._name=e.name,this._link=e.link,this._cardId=e._id,this._likes=e.likes,this._cardSelector=t,this._handleImageClick=s,this._handleDelete=i,this._handleLikeCard=r,this._currentUserId=n,this._owner=e.owner._id}_setEventListeners(){this.likeButton=this._element.querySelector(".card__like-button"),this.likeButton.addEventListener("click",(()=>this._setIsLiked(this))),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>this._handleDelete)),this._imageModal=this._element.querySelector(".card__image"),this._imageModal.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}handleLike(){this.isLiked?this.likeButton.classList.add("card__like-button_active"):this.likeButton.classList.remove("card__like-button_active")}isLiked(){return this._likes.some((e=>e._cardId===this._currentUserId))}deleteCard(){this._element.remove(),this._element=null}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this.handleLike(),this._element}};class r{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=this._formElement.querySelectorAll(this._inputSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this.disableButton()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class i{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".modal__close")}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class n extends i{constructor(e,t){super({popupSelector:e}),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button"),this._formInputs=this._popup.querySelectorAll("input"),this._handleFormSubmit=t,this._buttonText=this._submitButton.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._submitButton.textContent=e?"Loading...":this._buttonText}close(){this._form.reset(),super.close()}}class o{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._cardSelector=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._cardSelector.prepend(e)}}const a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".profile__avatar"),d=document.forms["card-form"],h=document.forms["profile-form"],u=document.querySelector("#profile-input-name"),_=document.querySelector("#profile-input-description"),p=new class{constructor(e){let{nameEl:t,descriptionEl:s,avatarEl:r}=e;this._nameEl=document.querySelector(t),this._descriptionEl=document.querySelector(s),this._link=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,description:this._descriptionEl.textContent,avatar:this._link.src}}setUserInfo(e){let{name:t,description:s}=e;this._nameEl.textContent=t,this._descriptionEl.textContent=s}setAvatarImage(e){this._link.src=e}}({nameEl:e.profileTitle,descriptionEl:e.profileDescription,avatarEl:e.profileAvatar}),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._url=t,this._headers=s,this._authorization=s.authorization}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}fetchUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}editProfileAvatar(e){let{link:t}=e;return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addNewCard(e){let{cardName:t,cardLink:s}=e;return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"174196d6-45bd-490a-bc0e-39b0754c7da9","Content-Type":"application/json"}});let f,v;Promise.all([m.fetchUserInfo(),m.getInitialCards()]).then((t=>{let[s,r]=t;v=s._id,p.setUserInfo({name:s.name,description:s.about}),p.setAvatarImage(s.avatar),f=new o({items:r,renderer:e=>{const t=g(e);f.addItem(t)}},e.cardsList),f.renderItems()})).catch((e=>{console.log(e)}));const E=e=>{C.open(e)},b=e=>{I.open(),I.setSubmitAction((()=>{I.renderLoading(!0),m.deleteCard(cardId).then((()=>{e.deleteCard(),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}))},L=e=>{e?m.removeLike(data).catch((e=>{console.log(e)})):m.addLike(data).catch((e=>{console.log(e)}))},g=e=>new t(e,E,L,b,v).generateCard(),S={};var k;k={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(k.formSelector)).forEach((e=>{const t=new r(k,e),s=e.getAttribute("name");S[s]=t,t.enableValidation()}));const y=new n(e.changeAvatarPopup,(e=>{y.renderLoading(!0),m.editProfileAvatar(e).then((e=>{p.setAvatarImage(e.avatar),y.close()})).catch((e=>{console.error(e)})).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners(),c.addEventListener("click",(()=>{y.open(),S[e.avatarForm.getAttribute("name")].resetValidation()}));const C=new class extends i{constructor(e){super({popupSelector:e}),this._modalName=this._popup.querySelector(".modal__name"),this._modalImage=this._popup.querySelector(".modal__image"),super.setEventListeners()}open(e){this._modalName.textContent=e.name,this._modalImage.alt=e.name,this._modalImage.src=e.link,super.open()}}(e.previewPopup);C.close();const I=new class extends i{constructor(e){super({popupSelector:e}),this._submitButton=this._popup.querySelector(".modal__button")}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}open(e){this._handleDeleteCallback=e,super.open()}setSubmitAction(e){this._handleDeleteSubmit=e}}(e.confirmDeleteModal,(e=>{b(e)}));I.setEventListeners();const B=new n(e.editFormPopup,(e=>{B.renderLoading(!0),m.editProfile(e).then((()=>{p.setUserInfo({name:e.name,description:e.description}),B.close()})).catch((e=>{console.error(e)})).finally((()=>{B.renderLoading(!1)}))}));B.setEventListeners(),a.addEventListener("click",(()=>{const{name:e,description:t}=p.getUserInfo();u.value=e,_.value=t,S[h.getAttribute("name")].resetValidation(),B.open()}));const q=new n(e.addFormPopup,(e=>{q.renderLoading(!0),m.addNewCard(e).then((e=>{const t=g(e);f.addItem(t),q.close()})).catch((e=>{console.log(e)})).finally((()=>{q.renderLoading(!1)}))}));q.setEventListeners(),l.addEventListener("click",(()=>{S[d.getAttribute("name")].resetValidation(),q.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmIgPSBkb2N1bWVudC5iYXNlVVJJIHx8IHNlbGYubG9jYXRpb24uaHJlZjtcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQxNzk6IDBcbn07XG5cbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbi8vIG5vIG9uIGNodW5rcyBsb2FkZWRcblxuLy8gbm8ganNvbnAgZnVuY3Rpb24iLCJjb25zdCBsYWdvRGlCcmFpZXNJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGFnby5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IHZhbm9pc2VOYXRpb25hbFBhcmtJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvdmFub2lzZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGxha2VMb3Vpc2VJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGFrZS1sb3Vpc2UuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBsYXRlbWFySW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2xhdGVtYXIuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBiYWxkTW91bnRhaW5zSW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2JhbGQtbW91bnRhaW5zLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgeW9zZW1pdGVWYWxsZXlJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMveW9zZW1pdGUuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgICAgIGxpbms6IGxhZ29EaUJyYWllc0ltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgICAgIGxpbms6IHZhbm9pc2VOYXRpb25hbFBhcmtJbWFnZVxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgICAgIGxpbms6IGxha2VMb3Vpc2VJbWFnZVxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICAgICAgbGluazogbGF0ZW1hckltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICAgICAgbGluazogYmFsZE1vdW50YWluc0ltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgICAgIGxpbms6IHlvc2VtaXRlVmFsbGV5SW1hZ2VcbiAgICB9XG5dO1xuXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG4gICAgZm9ybVNlbGVjdG9yOiBcImZvcm1cIixcbn07XG5cbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XG4gICAgY2FyZHNMaXN0OiAnLmNhcmRzX19saXN0JyxcbiAgICBjYXJkVGVtcGxhdGU6ICcjY2FyZC10ZW1wbGF0ZScsXG4gICAgcHJldmlld1BvcHVwOiAnI2ltYWdlLW1vZGFsJyxcbiAgICBlZGl0Rm9ybVBvcHVwOiAnI2VkaXQtbW9kYWwnLFxuICAgIGFkZEZvcm1Qb3B1cDogJyNhZGQtbW9kYWwnLFxuICAgIHByb2ZpbGVUaXRsZTogJy5wcm9maWxlX190aXRsZScsXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uOiAnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyxcbiAgICBwcm9maWxlQXZhdGFyOiAnLnByb2ZpbGVfX2F2YXRhcicsXG4gICAgZm9ybU1vZGFsQ29udGFpbmVyOiAnLm1vZGFsX19jb250YWluZXInLFxuICAgIGltYWdlTW9kYWxDb250YWluZXI6ICcubW9kYWxfX2NvbnRhaW5lci1pbWFnZScsXG4gICAgY2hhbmdlQXZhdGFyUG9wdXA6IFwiI2NoYW5nZS1hdmF0YXItbW9kYWxcIixcbiAgICBjb25maXJtRGVsZXRlTW9kYWw6IFwiI2NvbmZpcm0tZGVsZXRlLW1vZGFsXCIsXG59O1xuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlTGlrZUNhcmQsIGhhbmRsZURlbGV0ZSwgY3VycmVudFVzZXJJZCkge1xuICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcbiAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcblxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XG4gICAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXIuX2lkO1xuICAgIH1cbiAgICBcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cbiAgICAgIC8vbGlrZSBidXR0b25cbiAgICAgIHRoaXMubGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICAgIHRoaXMubGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX3NldElzTGlrZWQodGhpcykpO1xuXG4gICAgICAvL3RyYXNoIGJ1dHRvblxuICAgICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190cmFzaC1idXR0b24nKTtcbiAgICAgIHRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlKTtcblxuICAgICAgLy9pbWFnZSBtb2RhbCBjbGlja1xuICAgICAgdGhpcy5faW1hZ2VNb2RhbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XG4gICAgICB0aGlzLl9pbWFnZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7bGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZX0pKTtcbiAgICB9XG5cbiAgICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB9XG5cbiAgICBoYW5kbGVMaWtlKCkge1xuICAgICAgaWYodGhpcy5pc0xpa2VkKSB7XG4gICAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlzTGlrZWQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5fY2FyZElkID09PSB0aGlzLl9jdXJyZW50VXNlcklkKTtcbiAgICB9XG5cbiAgICBkZWxldGVDYXJkKCkge1xuICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICAgIH1cblxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgdGhpcy5oYW5kbGVMaWtlKCk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICAgIH1cbiAgfVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgICAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG5cbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIH1cblxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKVxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIH1cblxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGlmKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgICB9XG5cbiAgICBkaXNhYmxlQnV0dG9uKCkge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBfZW5hYmxlQnV0dG9uKCkge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBpZih0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKGlucHV0RWxlbWVudCA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpXG4gICAgfVxuXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcbiAgICAgICAgfSk7XG4gICAgfVxuXG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG5cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgICAgICBpZihldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Zvcm0nKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKTtcbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgICAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICAgIH1cblxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAgICAgY29uc3QgaW5wdXRPYmplY3QgPSB7fTtcblxuICAgICAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgaW5wdXRPYmplY3RbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGlucHV0T2JqZWN0O1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgICAgIGlmKGlzTG9hZGluZykge1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJMb2FkaW5nLi4uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxuICAgICAgICBzdXBlci5jbG9zZSgpOyAgICAgICAgXG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25Db25maWcsIGluaXRpYWxDYXJkcywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFN0eWxlcyBmcm9tIFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuXG5jb25zdCBhZGROZXdDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zWydjYXJkLWZvcm0nXTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zWydwcm9maWxlLWZvcm0nXTtcblxuY29uc3QgZm9ybUlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLWlucHV0LW5hbWUnKTtcbmNvbnN0IGZvcm1JbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtaW5wdXQtZGVzY3JpcHRpb24nKTtcblxuLy9Vc2VySW5mb1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgIG5hbWVFbDogc2VsZWN0b3JzLnByb2ZpbGVUaXRsZSwgXG4gICAgZGVzY3JpcHRpb25FbDogc2VsZWN0b3JzLnByb2ZpbGVEZXNjcmlwdGlvbiwgXG4gICAgYXZhdGFyRWw6IHNlbGVjdG9ycy5wcm9maWxlQXZhdGFyLFxufSk7XG5cbi8vQVBJIFxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGF1dGhvcml6YXRpb246IFwiMTc0MTk2ZDYtNDViZC00OTBhLWJjMGUtMzliMDc1NGM3ZGE5XCIsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICB9LFxufSk7XG5cbmxldCBzZWN0aW9uO1xubGV0IGN1cnJlbnRVc2VySWQ7XG5cblByb21pc2UuYWxsKFthcGkuZmV0Y2hVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgICAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UodXNlckRhdGEuYXZhdGFyKTtcbiAgICAgICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0b3JzLmNhcmRzTGlzdFxuICAgICAgICApO1xuICAgICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xuXG4vL3JlbmRlcmluZyBjYXJkIGhhbmRsZXJzXG5jb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKGltYWdlRGF0YSkgPT4ge1xuICAgIHBvcHVwSW1hZ2Uub3BlbihpbWFnZURhdGEpXG59XG5cbmNvbnN0IGhhbmRsZURlbGV0ZSA9IChjYXJkKSA9PiB7XG4gICAgY29uZmlybURlbGV0ZU1vZGFsLm9wZW4oKTtcbiAgICBjb25maXJtRGVsZXRlTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgICAgICBjb25maXJtRGVsZXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIH0pXG4gICAgfSlcbn1cblxuY29uc3QgaGFuZGxlTGlrZUNhcmQgPSAocmVtb3ZlTGlrZSkgPT4ge1xuICAgIGlmKHJlbW92ZUxpa2UpIHtcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoZGF0YSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXBpLmFkZExpa2UoZGF0YSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZUxpa2VDYXJkLCBoYW5kbGVEZWxldGUsIGN1cnJlbnRVc2VySWQsKTtcblxuICAgIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuLy8gdmFsaWRhdGlvblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChmb3JtVmFsaWRhdGlvbkNvbmZpZykgPT4ge1xuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvcm1WYWxpZGF0aW9uQ29uZmlnLmZvcm1TZWxlY3RvcikpO1xuXG4gICAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtVmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnQpO1xuICAgICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTsgXG5cbiAgICAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG4gICAgICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICB9KTtcbn1cblxuZW5hYmxlVmFsaWRhdGlvbihmb3JtVmFsaWRhdGlvbkNvbmZpZyk7XG5cbi8vIEFkZGluZyBOZXcgQ2FyZCBGb3JtIGhhbmRsZXJcbmNvbnN0IGhhbmRsZUFkZENhcmRTdWJtaXQgPSAoZGF0YSkgPT4ge1xuICAgIGFkZENhcmRGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpLmFkZE5ld0NhcmQoZGF0YSlcbiAgICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWwgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xuICAgICAgICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0pO1xufVxuXG4vL0VkaXQgUHJvZmlsZSBGb3JtIGhhbmRsZXJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGlucHV0KSA9PiB7XG4gICAgZWRpdFByb2ZpbGVNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaS5lZGl0UHJvZmlsZShpbnB1dClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICAgICAgICAgIG5hbWU6IGlucHV0Lm5hbWUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGlucHV0LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlZGl0UHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGVkaXRQcm9maWxlTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0pO1xufVxuXG5jb25zdCBvcGVuUHJvZmlsZU1vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24gfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gICAgZm9ybUlucHV0TmFtZS52YWx1ZSA9IG5hbWU7XG4gICAgZm9ybUlucHV0RGVzY3JpcHRpb24udmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgICBmb3JtVmFsaWRhdG9yc1twcm9maWxlRWRpdEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIGVkaXRQcm9maWxlTW9kYWwub3BlbigpO1xufVxuXG4vL0NoYW5naW5nIGF2YXRhciBoZWxwZXJcbmNvbnN0IGhhbmRsZVVwZGF0ZUF2YXRhciA9IChpbnB1dCkgPT4ge1xuICAgIHVwZGF0ZUF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpLmVkaXRQcm9maWxlQXZhdGFyKGlucHV0KVxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UoZGF0YS5hdmF0YXIpO1xuICAgICAgICAgICAgdXBkYXRlQXZhdGFyTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgdXBkYXRlQXZhdGFyTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0pXG59XG5cbi8vY2hhbmdlIGF2YXRhclxuY29uc3QgdXBkYXRlQXZhdGFyTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuY2hhbmdlQXZhdGFyUG9wdXAsIGhhbmRsZVVwZGF0ZUF2YXRhcik7XG51cGRhdGVBdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5wcm9maWxlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHVwZGF0ZUF2YXRhck1vZGFsLm9wZW4oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuYXZhdGFyRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KVxuXG4vL1BvcHVwV2l0aEltYWdlXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHNlbGVjdG9ycy5wcmV2aWV3UG9wdXApO1xucG9wdXBJbWFnZS5jbG9zZSgpO1xuXG4vL2RlbGV0ZSBtb2RhbFxuY29uc3QgY29uZmlybURlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oc2VsZWN0b3JzLmNvbmZpcm1EZWxldGVNb2RhbCwgXG4gICAgKGNhcmQpID0+IHtoYW5kbGVEZWxldGUoY2FyZCl9KTtcbmNvbmZpcm1EZWxldGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL2VkaXQgcHJvZmlsZVxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5lZGl0Rm9ybVBvcHVwLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5lZGl0UHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZU1vZGFsKVxuXG4vL2FkZCBuZXcgY2FyZFxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuYWRkRm9ybVBvcHVwLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBmb3JtVmFsaWRhdG9yc1thZGROZXdDYXJkRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgYWRkQ2FyZEZvcm0ub3BlbigpO1xufSkiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoeyBuYW1lRWwsIGRlc2NyaXB0aW9uRWwsIGF2YXRhckVsIH0pIHtcbiAgICAgICAgdGhpcy5fbmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWwpO1xuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvbkVsKTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyRWwpO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsLnRleHRDb250ZW50LFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBhdmF0YXI6IHRoaXMuX2xpbmsuc3JjLFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgICAgIHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgICB9XG5cbiAgICBzZXRBdmF0YXJJbWFnZShsaW5rKSB7XG4gICAgICAgIHRoaXMuX2xpbmsuc3JjID0gbGluaztcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgICAgICB0aGlzLl91cmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICAgICAgdGhpcy5fYXV0aG9yaXphdGlvbiA9IGhlYWRlcnMuYXV0aG9yaXphdGlvbjtcbiAgICB9XG5cbiAgICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG4gICAgICBcbiAgICBmZXRjaFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGVkaXRQcm9maWxlKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgICB9XG5cbiAgICBlZGl0UHJvZmlsZUF2YXRhcih7IGxpbmsgfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IFxuICAgICAgICAgICAgICAgIGF2YXRhcjogbGluayxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBhZGROZXdDYXJkKHsgY2FyZE5hbWUsIGNhcmRMaW5rIH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgXG4gICAgICAgICAgICAgICAgbmFtZTogY2FyZE5hbWUsIFxuICAgICAgICAgICAgICAgIGxpbms6IGNhcmRMaW5rLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGFkZExpa2UoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cblxuICAgIGRlbGV0ZUxpa2UoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgIH1cbiAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgICAgdGhpcy5fbW9kYWxOYW1lID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19uYW1lJyk7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlJyk7XG5cbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBvcGVuKGltYWdlRGF0YSkge1xuICAgICAgICB0aGlzLl9tb2RhbE5hbWUudGV4dENvbnRlbnQgPSBpbWFnZURhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBpbWFnZURhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbW9kYWxJbWFnZS5zcmMgPSBpbWFnZURhdGEubGluaztcblxuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9wZW4oaGFuZGxlRGVsZXRlQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FsbGJhY2sgPSBoYW5kbGVEZWxldGVDYWxsYmFjaztcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cblxuICAgIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gYWN0aW9uO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJvIiwib2JqIiwicHJvcCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInAiLCJiIiwiZG9jdW1lbnQiLCJiYXNlVVJJIiwic2VsZiIsImxvY2F0aW9uIiwiaHJlZiIsIlVSTCIsInNlbGVjdG9ycyIsImNhcmRzTGlzdCIsImNhcmRUZW1wbGF0ZSIsInByZXZpZXdQb3B1cCIsImVkaXRGb3JtUG9wdXAiLCJhZGRGb3JtUG9wdXAiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiZm9ybU1vZGFsQ29udGFpbmVyIiwiaW1hZ2VNb2RhbENvbnRhaW5lciIsImNoYW5nZUF2YXRhclBvcHVwIiwiY29uZmlybURlbGV0ZU1vZGFsIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlRGVsZXRlIiwiY3VycmVudFVzZXJJZCIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZElkIiwiX2lkIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2N1cnJlbnRVc2VySWQiLCJfb3duZXIiLCJvd25lciIsIl9zZXRFdmVudExpc3RlbmVycyIsImxpa2VCdXR0b24iLCJfZWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX3NldElzTGlrZWQiLCJfaW1hZ2VNb2RhbCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJoYW5kbGVMaWtlIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInNvbWUiLCJsaWtlIiwiZGVsZXRlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVsZW1lbnRzIiwiZXZlcnkiLCJkaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9jbG9zZUJ1dHRvbiIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNsb3NlIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm0iLCJfZm9ybUlucHV0cyIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dE9iamVjdCIsImlucHV0IiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJhZGROZXdDYXJkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwiZm9ybUlucHV0TmFtZSIsImZvcm1JbnB1dERlc2NyaXB0aW9uIiwidXNlckluZm8iLCJuYW1lRWwiLCJkZXNjcmlwdGlvbkVsIiwiYXZhdGFyRWwiLCJfbmFtZUVsIiwiX2Rlc2NyaXB0aW9uRWwiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwiYXZhdGFyIiwic2V0VXNlckluZm8iLCJfcmVmMiIsInNldEF2YXRhckltYWdlIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfdXJsIiwiX2hlYWRlcnMiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJmZXRjaFVzZXJJbmZvIiwiZWRpdFByb2ZpbGUiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZWRpdFByb2ZpbGVBdmF0YXIiLCJfcmVmMyIsImFkZE5ld0NhcmQiLCJfcmVmNCIsImNhcmROYW1lIiwiY2FyZExpbmsiLCJjYXJkSWQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsInNlY3Rpb24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwiY2FyZCIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJpbWFnZURhdGEiLCJwb3B1cEltYWdlIiwic2V0U3VibWl0QWN0aW9uIiwiZmluYWxseSIsInJlbW92ZUxpa2UiLCJDYXJkIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwidXBkYXRlQXZhdGFyTW9kYWwiLCJlcnJvciIsImF2YXRhckZvcm0iLCJfbW9kYWxOYW1lIiwiX21vZGFsSW1hZ2UiLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiaGFuZGxlRGVsZXRlQ2FsbGJhY2siLCJfaGFuZGxlRGVsZXRlQ2FsbGJhY2siLCJhY3Rpb24iLCJlZGl0UHJvZmlsZU1vZGFsIiwib3BlblByb2ZpbGVNb2RhbCIsImFkZENhcmRGb3JtIiwiY2FyZERhdGEiLCJjYXJkRWwiXSwic291cmNlUm9vdCI6IiJ9