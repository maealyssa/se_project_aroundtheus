!function(){"use strict";var e={960:function(e,t,s){e.exports=s.p+"190142da37235e3079a8.jpg"},291:function(e,t,s){e.exports=s.p+"9aed7cb3f54c0faa1f9f.jpg"},822:function(e,t,s){e.exports=s.p+"0fb96793ab89da938a7d.jpg"},328:function(e,t,s){e.exports=s.p+"395d21149564d1293c88.jpg"},705:function(e,t,s){e.exports=s.p+"a22751dd8a0e22ceb5f6.jpg"},561:function(e,t,s){e.exports=s.p+"0df918d480d675e4708e.jpg"}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.m=e,s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.b=document.baseURI||self.location.href,function(){new URL(s(291),s.b),new URL(s(705),s.b),new URL(s(822),s.b),new URL(s(328),s.b),new URL(s(960),s.b),new URL(s(561),s.b);var e=class{constructor(e,t,s,i,r,n){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDelete=n,this._handleLikeCard=i,this._handleDislikeCard=r}_setEventListeners(){this.likeButton.addEventListener("click",(()=>{this._handleLike(this)})),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>this._handleDelete())),this._imageModal=this._element.querySelector(".card__image"),this._imageModal.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_handleLike(){this._isLiked?this._handleDislikeCard():this._isLiked||this._handleLikeCard()}deleteCard(){this._element.remove()}addLike(){this.likeButton.classList.add("card__like-button_active"),this._isLiked=!0}disLike(){this.likeButton.classList.remove("card__like-button_active"),this._isLiked=!1}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this.likeButton=this._element.querySelector(".card__like-button"),!0===this._isLiked?this.addLike(this._id):!1===this._isLiked&&this.disLike(this._id),this._setEventListeners(),this._element}};class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=this._formElement.querySelectorAll(this._inputSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class i{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".modal__close")}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class r extends i{constructor(e,t){super({popupSelector:e}),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button"),this._formInputs=this._popup.querySelectorAll("input"),this._handleFormSubmit=t,this._buttonText=this._submitButton.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._buttonText}close(){this._form.reset(),super.close()}}class n{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._cardsList=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._cardsList.prepend(e)}}const o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__avatar-edit"),d=document.forms["card-form"],c=document.forms["profile-form"],h=document.forms["avatar-form"],u=document.querySelector("#profile-input-name"),_=document.querySelector("#profile-input-description"),m=new class{constructor(e){let{nameEl:t,descriptionEl:s,avatarEl:i}=e;this._nameEl=document.querySelector(t),this._descriptionEl=document.querySelector(s),this._link=document.querySelector(i)}getUserInfo(){return{name:this._nameEl.textContent,description:this._descriptionEl.textContent,avatar:this._link.src}}setUserInfo(e){let{name:t,description:s}=e;this._nameEl.textContent=t,this._descriptionEl.textContent=s}setAvatarImage(e){this._link.src=e}}({nameEl:".profile__title",descriptionEl:".profile__description",avatarEl:".profile__avatar"}),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._url=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._url}/cards`,{headers:this._headers})}fetchUserInfo(){return this._request(`${this._url}/users/me`,{headers:this._headers})}editProfile(e){let{name:t,description:s}=e;return this._request(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})})}editProfileAvatar(e){let{link:t}=e;return this._request(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})})}addNewCard(e){let{cardName:t,cardLink:s}=e;return this._request(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return this._request(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers})}addLike(e){return this._request(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}deleteLike(e){return this._request(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d8e635dc-b9a3-40bb-8b8a-44b118a2b105","Content-Type":"application/json"}});let f,v;Promise.all([p.fetchUserInfo(),p.getInitialCards()]).then((e=>{let[t,s]=e;v=t._id,m.setUserInfo({name:t.name,description:t.about}),m.setAvatarImage(t.avatar),f=new n({items:s,renderer:e=>{const t=E(e);f.addItem(t)}},".cards__list"),f.renderItems()})).catch((e=>{console.log(e)}));const L=e=>{S.open(e)},E=t=>{const s=new e(t,"#card-template",L,(()=>{p.addLike(t._id).then(s.addLike()).catch((e=>console.log(e)))}),(()=>{p.deleteLike(t._id).then(s.disLike()).catch((e=>console.log(e)))}),(()=>{y.open(),y.setSubmitAction((()=>{p.deleteCard(t._id).then((()=>{s.deleteCard(),y.close()})).catch((e=>{console.log(e)}))}))}));return s.generateCard()},b={};var k;k={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(k.formSelector)).forEach((e=>{const s=new t(k,e),i=e.getAttribute("name");b[i]=s,s.enableValidation()}));const g=new r("#change-avatar-modal",(e=>{g.renderLoading(!0),p.editProfileAvatar(e).then((e=>{m.setAvatarImage(e.avatar),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.renderLoading(!1)}))}));g.setEventListeners(),l.addEventListener("click",(()=>{g.open(),b[h.getAttribute("name")].resetValidation()}));const S=new class extends i{constructor(e){super({popupSelector:e}),this._modalName=this._popup.querySelector(".modal__name"),this._modalImage=this._popup.querySelector(".modal__image"),super.setEventListeners()}open(e){this._modalName.textContent=e.name,this._modalImage.alt=e.name,this._modalImage.src=e.link,super.open()}}("#image-modal");S.close();const y=new class extends i{constructor(e){super({popupSelector:e}),this._form=this._popup.querySelector("form")}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}setSubmitAction(e){this._handleDeleteSubmit=e}}("#confirm-delete-modal");y.setEventListeners();const C=new r("#edit-modal",(e=>{C.renderLoading(!0),p.editProfile(e).then((()=>{m.setUserInfo({name:e.name,description:e.description}),C.close()})).catch((e=>{console.error(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners(),o.addEventListener("click",(()=>{const{name:e,description:t}=m.getUserInfo();u.value=e,_.value=t,b[c.getAttribute("name")].resetValidation(),C.open()}));const q=new r("#add-modal",(e=>{q.renderLoading(!0),p.addNewCard({cardName:e.name,cardLink:e.link}).then((e=>{const t=E(e);f.addItem(t),q.close()})).catch((e=>{console.log(e)})).finally((()=>{q.renderLoading(!1)}))}));q.setEventListeners(),a.addEventListener("click",(()=>{b[d.getAttribute("name")].resetValidation(),q.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sR0FDdkMsSUFrRFZxRyxFQUFpQnpILG9CQUVqQm1DLEVBQVdsRyxpQkFBaUIsU0FqREh5TCxLQUNyQixNQUFNLEtBQUV0TSxFQUFJLFlBQUUrSCxHQUFnQlAsRUFBU00sY0FDdkNSLEVBQWN2QixNQUFRL0YsRUFDdEJ1SCxFQUFxQnhCLE1BQVFnQyxFQUM3QnVELEVBQWVsRSxFQUFnQnlFLGFBQWEsU0FBU3ZILGtCQUNyRCtILEVBQWlCcEgsTUFBTSxJQStDM0IsTUFBTXNILEVBQWMsSUFBSWxILEVOaExOLGNNc0ZXN0YsSUFDekIrTSxFQUFZdkcsZUFBYyxHQUMxQm9DLEVBQUkyQixXQUFXLENBQ1hFLFNBQVV6SyxFQUFLUSxLQUNma0ssU0FBVTFLLEVBQUtVLE9BRWRrSixNQUFNb0QsSUFDSCxNQUFNQyxFQUFTN0IsRUFBVzRCLEdBQzFCbEMsRUFBUTFELFFBQVE2RixHQUNoQkYsRUFBWXZILE9BQU8sSUFFdEI2RixPQUFPQyxJQUNKQyxRQUFRQyxJQUFJRixFQUFJLElBRW5Ca0IsU0FBUSxLQUNMTyxFQUFZdkcsZUFBYyxFQUFNLEdBQ2xDLElBMkVWdUcsRUFBWTNILG9CQUVab0MsRUFBVW5HLGlCQUFpQixTQUFTLEtBQ2hDeUssRUFBZXBFLEVBQWUyRSxhQUFhLFNBQVN2SCxrQkFDcERpSSxFQUFZdEgsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpcGxldGVuL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIl9fd2VicGFja19yZXF1aXJlX18uYiA9IGRvY3VtZW50LmJhc2VVUkkgfHwgc2VsZi5sb2NhdGlvbi5ocmVmO1xuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuLy8gbm8gY2h1bmsgb24gZGVtYW5kIGxvYWRpbmdcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG4vLyBubyBqc29ucCBmdW5jdGlvbiIsImNvbnN0IGxhZ29EaUJyYWllc0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWdvLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy92YW5vaXNlLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgbGFrZUxvdWlzZUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWtlLWxvdWlzZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGxhdGVtYXJJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGF0ZW1hci5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGJhbGRNb3VudGFpbnNJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvYmFsZC1tb3VudGFpbnMuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCB5b3NlbWl0ZVZhbGxleUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy95b3NlbWl0ZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgICAgbGluazogbGFnb0RpQnJhaWVzSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICAgICAgbGluazogdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgICAgbGluazogbGFrZUxvdWlzZUltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgICAgICBsaW5rOiBsYXRlbWFySW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgICBsaW5rOiBiYWxkTW91bnRhaW5zSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICAgICAgbGluazogeW9zZW1pdGVWYWxsZXlJbWFnZVxuICAgIH1cbl07XG5cbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbiAgICBmb3JtU2VsZWN0b3I6IFwiZm9ybVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgICBjYXJkc0xpc3Q6ICcuY2FyZHNfX2xpc3QnLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLXRlbXBsYXRlJyxcbiAgICBwcmV2aWV3UG9wdXA6ICcjaW1hZ2UtbW9kYWwnLFxuICAgIGVkaXRGb3JtUG9wdXA6ICcjZWRpdC1tb2RhbCcsXG4gICAgYWRkRm9ybVBvcHVwOiAnI2FkZC1tb2RhbCcsXG4gICAgcHJvZmlsZVRpdGxlOiAnLnByb2ZpbGVfX3RpdGxlJyxcbiAgICBwcm9maWxlRGVzY3JpcHRpb246ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nLFxuICAgIHByb2ZpbGVBdmF0YXI6ICcucHJvZmlsZV9fYXZhdGFyJyxcbiAgICBmb3JtTW9kYWxDb250YWluZXI6ICcubW9kYWxfX2NvbnRhaW5lcicsXG4gICAgaW1hZ2VNb2RhbENvbnRhaW5lcjogJy5tb2RhbF9fY29udGFpbmVyLWltYWdlJyxcbiAgICBjaGFuZ2VBdmF0YXJQb3B1cDogXCIjY2hhbmdlLWF2YXRhci1tb2RhbFwiLFxuICAgIGNvbmZpcm1EZWxldGVNb2RhbDogXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIixcbn07XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVMaWtlQ2FyZCwgaGFuZGxlRGlzbGlrZUNhcmQsIGhhbmRsZURlbGV0ZSkge1xuICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDsgXG5cbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcbiAgICAgIHRoaXMuX2hhbmRsZURpc2xpa2VDYXJkID0gaGFuZGxlRGlzbGlrZUNhcmQ7XG4gICAgfVxuICAgIFxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcblxuICAgICAgLy9saWtlIGJ1dHRvblxuICAgICAgdGhpcy5saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vdHJhc2ggYnV0dG9uXG4gICAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RyYXNoLWJ1dHRvbicpO1xuICAgICAgdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGUoKSk7XG5cbiAgICAgIC8vaW1hZ2UgbW9kYWwgY2xpY2tcbiAgICAgIHRoaXMuX2ltYWdlTW9kYWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xuICAgICAgdGhpcy5faW1hZ2VNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe2xpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWV9KSk7XG4gICAgfVxuXG4gICAgX2dldFRlbXBsYXRlKCkge1xuICAgICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZFxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB9XG5cbiAgICBfaGFuZGxlTGlrZSgpIHtcbiAgICAgIGlmKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGlzbGlrZUNhcmQoKTtcbiAgICAgIH0gZWxzZSBpZighdGhpcy5faXNMaWtlZCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cblxuICAgIGFkZExpa2UoKSB7XG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIHRoaXMuX2lzTGlrZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGRpc0xpa2UoKSB7XG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIHRoaXMuX2lzTGlrZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcblxuICAgICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgICAgdGhpcy5saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgICAgaWYodGhpcy5faXNMaWtlZCA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLmFkZExpa2UodGhpcy5faWQpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9pc0xpa2VkID09PSBmYWxzZSkge1xuICAgICAgICB0aGlzLmRpc0xpa2UodGhpcy5faWQpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG4gIH1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZighaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gICAgfVxuXG4gICAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICAgICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAvLyB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICAgIH1cblxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICAgICAgaWYoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICAgICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB9XG5cbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0T2JqZWN0ID0ge307XG5cbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgICAgIGlucHV0T2JqZWN0W2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBpbnB1dE9iamVjdDtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgICAgICBpZihpc0xvYWRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxuICAgICAgICBzdXBlci5jbG9zZSgpOyAgICAgICAgXG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRzTGlzdCkge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRzTGlzdCk7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jYXJkc0xpc3QucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25Db25maWcsIGluaXRpYWxDYXJkcywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFN0eWxlcyBmcm9tIFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1lZGl0Jyk7XG5cbmNvbnN0IGFkZE5ld0NhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2NhcmQtZm9ybSddO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb2ZpbGUtZm9ybSddO1xuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zWydhdmF0YXItZm9ybSddO1xuXG5jb25zdCBmb3JtSW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtaW5wdXQtbmFtZScpO1xuY29uc3QgZm9ybUlucHV0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZS1pbnB1dC1kZXNjcmlwdGlvbicpO1xuXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXIgSW5mbyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gICAgbmFtZUVsOiBzZWxlY3RvcnMucHJvZmlsZVRpdGxlLCBcbiAgICBkZXNjcmlwdGlvbkVsOiBzZWxlY3RvcnMucHJvZmlsZURlc2NyaXB0aW9uLCBcbiAgICBhdmF0YXJFbDogc2VsZWN0b3JzLnByb2ZpbGVBdmF0YXIsXG59KTtcblxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQSSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGF1dGhvcml6YXRpb246IFwiZDhlNjM1ZGMtYjlhMy00MGJiLThiOGEtNDRiMTE4YTJiMTA1XCIsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICB9LFxufSk7XG5cbmxldCBzZWN0aW9uO1xubGV0IGN1cnJlbnRVc2VySWQ7XG5cblByb21pc2UuYWxsKFthcGkuZmV0Y2hVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgICAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UodXNlckRhdGEuYXZhdGFyKTtcbiAgICAgICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0b3JzLmNhcmRzTGlzdFxuICAgICAgICApO1xuICAgICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xuXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJpbmcgY2FyZHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG5jb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKGltYWdlRGF0YSkgPT4ge1xuICAgIHBvcHVwSW1hZ2Uub3BlbihpbWFnZURhdGEpXG59XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgZGF0YSwgXG4gICAgICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUsIFxuICAgICAgICBoYW5kbGVJbWFnZUNsaWNrLCBcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgYXBpLmFkZExpa2UoZGF0YS5faWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oY2FyZC5hZGRMaWtlKCkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgICAgICAgfSxcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgYXBpLmRlbGV0ZUxpa2UoZGF0YS5faWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oY2FyZC5kaXNMaWtlKCkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgICAgICAgfSwgXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICBjb25maXJtRGVsZXRlTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChkYXRhLl9pZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtRGVsZXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59O1xuXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGZvcm1WYWxpZGF0aW9uQ29uZmlnKSA9PiB7XG4gICAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZm9ybVZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpOyBcblxuICAgICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICAgIH0pO1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKGZvcm1WYWxpZGF0aW9uQ29uZmlnKTtcblxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhhbmRsZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuXG4vLyBBZGRpbmcgTmV3IENhcmQgRm9ybSBoYW5kbGVyXG5jb25zdCBoYW5kbGVBZGRDYXJkU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgICBhZGRDYXJkRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaS5hZGROZXdDYXJkKHtcbiAgICAgICAgY2FyZE5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgY2FyZExpbms6IGRhdGEubGluayxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWwgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xuICAgICAgICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0pO1xufVxuXG4vL0VkaXQgUHJvZmlsZSBGb3JtIGhhbmRsZXJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGlucHV0KSA9PiB7XG4gICAgZWRpdFByb2ZpbGVNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaS5lZGl0UHJvZmlsZShpbnB1dClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICAgICAgICAgIG5hbWU6IGlucHV0Lm5hbWUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGlucHV0LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlZGl0UHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGVkaXRQcm9maWxlTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH0pO1xufVxuXG5jb25zdCBvcGVuUHJvZmlsZU1vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24gfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gICAgZm9ybUlucHV0TmFtZS52YWx1ZSA9IG5hbWU7XG4gICAgZm9ybUlucHV0RGVzY3JpcHRpb24udmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgICBmb3JtVmFsaWRhdG9yc1twcm9maWxlRWRpdEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIGVkaXRQcm9maWxlTW9kYWwub3BlbigpO1xufVxuXG4vL0NoYW5naW5nIGF2YXRhciBoYW5kbGVyXG5jb25zdCBoYW5kbGVVcGRhdGVBdmF0YXIgPSAoaW5wdXQpID0+IHtcbiAgICB1cGRhdGVBdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaS5lZGl0UHJvZmlsZUF2YXRhcihpbnB1dClcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIHVzZXJJbmZvLnNldEF2YXRhckltYWdlKGRhdGEuYXZhdGFyKTtcbiAgICAgICAgICAgIHVwZGF0ZUF2YXRhck1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIHVwZGF0ZUF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9KVxufVxuXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzIGluc3RhbnRpYXRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG5cbi8vY2hhbmdlIGF2YXRhclxuY29uc3QgdXBkYXRlQXZhdGFyTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuY2hhbmdlQXZhdGFyUG9wdXAsIGhhbmRsZVVwZGF0ZUF2YXRhcik7XG51cGRhdGVBdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5wcm9maWxlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHVwZGF0ZUF2YXRhck1vZGFsLm9wZW4oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1t1cGRhdGVBdmF0YXJGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pXG5cbi8vUG9wdXBXaXRoSW1hZ2VcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdQb3B1cCk7XG5wb3B1cEltYWdlLmNsb3NlKCk7XG5cbi8vZGVsZXRlIG1vZGFsXG5jb25zdCBjb25maXJtRGVsZXRlTW9kYWwgPSBuZXcgUG9wdXBXaXRoQ29uZmlybShzZWxlY3RvcnMuY29uZmlybURlbGV0ZU1vZGFsKTtcbmNvbmZpcm1EZWxldGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL2VkaXQgcHJvZmlsZVxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5lZGl0Rm9ybVBvcHVwLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5lZGl0UHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuUHJvZmlsZU1vZGFsKVxuXG4vL2FkZCBuZXcgY2FyZFxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuYWRkRm9ybVBvcHVwLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBmb3JtVmFsaWRhdG9yc1thZGROZXdDYXJkRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgYWRkQ2FyZEZvcm0ub3BlbigpO1xufSkiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoeyBuYW1lRWwsIGRlc2NyaXB0aW9uRWwsIGF2YXRhckVsIH0pIHtcbiAgICAgICAgdGhpcy5fbmFtZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWwpO1xuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvbkVsKTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyRWwpO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsLnRleHRDb250ZW50LFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBhdmF0YXI6IHRoaXMuX2xpbmsuc3JjLFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgICAgIHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgICB9XG5cbiAgICBzZXRBdmF0YXJJbWFnZShsaW5rKSB7XG4gICAgICAgIHRoaXMuX2xpbmsuc3JjID0gbGluaztcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgICAgICB0aGlzLl91cmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICB9XG5cbiAgICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICAgICAgaWYocmVzLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgICBcbiAgICBmZXRjaFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZWRpdFByb2ZpbGUoeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgIGVkaXRQcm9maWxlQXZhdGFyKHsgbGluayB9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkTmV3Q2FyZCh7IGNhcmROYW1lLCBjYXJkTGluayB9KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgXG4gICAgICAgICAgICAgICAgbmFtZTogY2FyZE5hbWUsIFxuICAgICAgICAgICAgICAgIGxpbms6IGNhcmRMaW5rLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkTGlrZShjYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZWxldGVMaWtlKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgICAgdGhpcy5fbW9kYWxOYW1lID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19uYW1lJyk7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlJyk7XG5cbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBvcGVuKGltYWdlRGF0YSkge1xuICAgICAgICB0aGlzLl9tb2RhbE5hbWUudGV4dENvbnRlbnQgPSBpbWFnZURhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbW9kYWxJbWFnZS5hbHQgPSBpbWFnZURhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbW9kYWxJbWFnZS5zcmMgPSBpbWFnZURhdGEubGluaztcblxuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pOyAgICAgICAgXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gYWN0aW9uO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJvIiwib2JqIiwicHJvcCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInAiLCJiIiwiZG9jdW1lbnQiLCJiYXNlVVJJIiwic2VsZiIsImxvY2F0aW9uIiwiaHJlZiIsIlVSTCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVMaWtlQ2FyZCIsImhhbmRsZURpc2xpa2VDYXJkIiwiaGFuZGxlRGVsZXRlIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGUiLCJfaGFuZGxlTGlrZUNhcmQiLCJfaGFuZGxlRGlzbGlrZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJsaWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2ltYWdlTW9kYWwiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJkZWxldGVDYXJkIiwicmVtb3ZlIiwiYWRkTGlrZSIsImNsYXNzTGlzdCIsImFkZCIsImRpc0xpa2UiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkSW1hZ2UiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbGVtZW50cyIsImV2ZXJ5IiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfY2xvc2VCdXR0b24iLCJzZXRFdmVudExpc3RlbmVycyIsImV2dCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2Zvcm1JbnB1dHMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9idXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRPYmplY3QiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInJlc2V0IiwiU2VjdGlvbiIsImNhcmRzTGlzdCIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY2FyZHNMaXN0IiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInByb2ZpbGVBdmF0YXIiLCJhZGROZXdDYXJkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwidXBkYXRlQXZhdGFyRm9ybSIsImZvcm1JbnB1dE5hbWUiLCJmb3JtSW5wdXREZXNjcmlwdGlvbiIsInVzZXJJbmZvIiwibmFtZUVsIiwiZGVzY3JpcHRpb25FbCIsImF2YXRhckVsIiwiX25hbWVFbCIsIl9kZXNjcmlwdGlvbkVsIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsImF2YXRhciIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJzZXRBdmF0YXJJbWFnZSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX3VybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2hVc2VySW5mbyIsImVkaXRQcm9maWxlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImVkaXRQcm9maWxlQXZhdGFyIiwiX3JlZjMiLCJhZGROZXdDYXJkIiwiX3JlZjQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiY2FyZElkIiwiZGVsZXRlTGlrZSIsImF1dGhvcml6YXRpb24iLCJzZWN0aW9uIiwiY3VycmVudFVzZXJJZCIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHMiLCJjYXJkIiwicmVuZGVyQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImltYWdlRGF0YSIsInBvcHVwSW1hZ2UiLCJDYXJkIiwiY29uZmlybURlbGV0ZU1vZGFsIiwic2V0U3VibWl0QWN0aW9uIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwidXBkYXRlQXZhdGFyTW9kYWwiLCJlcnJvciIsImZpbmFsbHkiLCJfbW9kYWxOYW1lIiwiX21vZGFsSW1hZ2UiLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiYWN0aW9uIiwiZWRpdFByb2ZpbGVNb2RhbCIsIm9wZW5Qcm9maWxlTW9kYWwiLCJhZGRDYXJkRm9ybSIsImNhcmREYXRhIiwiY2FyZEVsIl0sInNvdXJjZVJvb3QiOiIifQ==