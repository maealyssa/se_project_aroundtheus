!function(){"use strict";var e={960:function(e,t,s){e.exports=s.p+"190142da37235e3079a8.jpg"},291:function(e,t,s){e.exports=s.p+"9aed7cb3f54c0faa1f9f.jpg"},822:function(e,t,s){e.exports=s.p+"0fb96793ab89da938a7d.jpg"},328:function(e,t,s){e.exports=s.p+"395d21149564d1293c88.jpg"},705:function(e,t,s){e.exports=s.p+"a22751dd8a0e22ceb5f6.jpg"},561:function(e,t,s){e.exports=s.p+"0df918d480d675e4708e.jpg"}},t={};function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.m=e,s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.b=document.baseURI||self.location.href,function(){new URL(s(291),s.b),new URL(s(705),s.b),new URL(s(822),s.b),new URL(s(328),s.b),new URL(s(960),s.b),new URL(s(561),s.b);var e=class{constructor(e,t,s,r,n,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked,e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDelete=n,this._handleLikeCard=r,this._currentUserId=i}_setEventListeners(){this.likeButton=this._element.querySelector(".card__like-button"),this.likeButton.addEventListener("click",(()=>{this._handleLikeCard(),this._handleLike()})),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>this._handleDelete())),this._imageModal=this._element.querySelector(".card__image"),this._imageModal.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_handleLike(){this.likeButton.classList.toggle("card__like-button_active")}deleteCard(){this._element.remove(),this._element=null}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}};class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=this._formElement.querySelectorAll(this._inputSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".modal__close")}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class n extends r{constructor(e,t){super({popupSelector:e}),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button"),this._formInputs=this._popup.querySelectorAll("input"),this._handleFormSubmit=t,this._buttonText=this._submitButton.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())}))}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._buttonText}close(){this._form.reset(),super.close()}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._cardSelector=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._cardSelector.prepend(e)}}const o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__avatar"),c=document.forms["card-form"],d=document.forms["profile-form"],h=document.forms["avatar-form"],u=document.querySelector("#profile-input-name"),_=document.querySelector("#profile-input-description"),m=new class{constructor(e){let{nameEl:t,descriptionEl:s,avatarEl:r}=e;this._nameEl=document.querySelector(t),this._descriptionEl=document.querySelector(s),this._link=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,description:this._descriptionEl.textContent,avatar:this._link.src}}setUserInfo(e){let{name:t,description:s}=e;this._nameEl.textContent=t,this._descriptionEl.textContent=s}setAvatarImage(e){this._link.src=e}}({nameEl:".profile__title",descriptionEl:".profile__description",avatarEl:".profile__avatar"}),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._url=t,this._headers=s,this._authorization=s.authorization}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}fetchUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}editProfile(e){let{name:t,description:s}=e;return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}editProfileAvatar(e){let{link:t}=e;return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}addNewCard(e){let{cardName:t,cardLink:s}=e;return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}deleteLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d8e635dc-b9a3-40bb-8b8a-44b118a2b105","Content-Type":"application/json"}});let f,v;Promise.all([p.fetchUserInfo(),p.getInitialCards()]).then((e=>{let[t,s]=e;v=t._id,m.setUserInfo({name:t.name,description:t.about}),m.setAvatarImage(t.avatar),f=new i({items:s,renderer:e=>{const t=b(e);f.addItem(t)}},".cards__list"),f.renderItems()})).catch((e=>{console.log(e)}));const E=e=>{k.open(e)},b=t=>{const s=new e(t,"#card-template",E,(()=>{t.isLiked?p.deleteLike(t._id).catch((e=>{console.log(e)})):p.addLike(t._id).catch((e=>{console.log(e)}))}),(()=>{y.open(),y.setSubmitAction((()=>{p.deleteCard(t._id).then((()=>{s.deleteCard(),y.close()})).catch((e=>{console.log(e)}))}))}),v);return s.generateCard()},L={};var g;g={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(g.formSelector)).forEach((e=>{const s=new t(g,e),r=e.getAttribute("name");L[r]=s,s.enableValidation()}));const S=new n("#change-avatar-modal",(e=>{S.renderLoading(!0),p.editProfileAvatar(e).then((e=>{m.setAvatarImage(e.avatar),S.close()})).catch((e=>{console.error(e)})).finally((()=>{S.renderLoading(!1)}))}));S.setEventListeners(),l.addEventListener("click",(()=>{S.open(),L[h.getAttribute("name")].resetValidation()}));const k=new class extends r{constructor(e){super({popupSelector:e}),this._modalName=this._popup.querySelector(".modal__name"),this._modalImage=this._popup.querySelector(".modal__image"),super.setEventListeners()}open(e){this._modalName.textContent=e.name,this._modalImage.alt=e.name,this._modalImage.src=e.link,super.open()}}("#image-modal");k.close();const y=new class extends r{constructor(e){super({popupSelector:e}),this._form=this._popup.querySelector("form")}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}setSubmitAction(e){this._handleDeleteSubmit=e}}("#confirm-delete-modal");y.setEventListeners();const C=new n("#edit-modal",(e=>{C.renderLoading(!0),p.editProfile(e).then((()=>{m.setUserInfo({name:e.name,description:e.description}),C.close()})).catch((e=>{console.error(e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners(),o.addEventListener("click",(()=>{const{name:e,description:t}=m.getUserInfo();u.value=e,_.value=t,L[d.getAttribute("name")].resetValidation(),C.open()}));const I=new n("#add-modal",(e=>{I.renderLoading(!0),p.addNewCard({cardName:e.name,cardLink:e.link}).then((e=>{const t=b({name:e.name,link:e.link,id:e._id});f.addItem(t),I.close()})).catch((e=>{console.log(e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),a.addEventListener("click",(()=>{L[c.getAttribute("name")].resetValidation(),I.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJoSCxNQUFNLElBK0MzQixNQUFNa0gsRUFBYyxJQUFJOUcsRU4zS04sY002RVc1RixJQUN6QjBNLEVBQVluRyxlQUFjLEdBQzFCa0MsRUFBSTBCLFdBQVcsQ0FDWEUsU0FBVXJLLEVBQUtRLEtBQ2Y4SixTQUFVdEssRUFBS1UsT0FFZCtJLE1BQU1rRCxJQUNILE1BQU1DLEVBQVM3QixFQUFXLENBQ3RCdkssS0FBTW1NLEVBQVNuTSxLQUNmRSxLQUFNaU0sRUFBU2pNLEtBQ2ZnRCxHQUFJaUosRUFBU2hNLE1BRWpCK0osRUFBUXpELFFBQVEyRixHQUNoQkYsRUFBWW5ILE9BQU8sSUFFdEJ5RixPQUFPQyxJQUNKQyxRQUFRQyxJQUFJRixFQUFJLElBRW5Ca0IsU0FBUSxLQUNMTyxFQUFZbkcsZUFBYyxFQUFNLEdBQ2xDLElBMkVWbUcsRUFBWXZILG9CQUVaa0MsRUFBVTlGLGlCQUFpQixTQUFTLEtBQ2hDa0ssRUFBZWxFLEVBQWV5RSxhQUFhLFNBQVNuSCxrQkFDcEQ2SCxFQUFZbEgsTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHJpcGxldGVuL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIl9fd2VicGFja19yZXF1aXJlX18uYiA9IGRvY3VtZW50LmJhc2VVUkkgfHwgc2VsZi5sb2NhdGlvbi5ocmVmO1xuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuLy8gbm8gY2h1bmsgb24gZGVtYW5kIGxvYWRpbmdcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG4vLyBubyBqc29ucCBmdW5jdGlvbiIsImNvbnN0IGxhZ29EaUJyYWllc0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWdvLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy92YW5vaXNlLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgbGFrZUxvdWlzZUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWtlLWxvdWlzZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGxhdGVtYXJJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGF0ZW1hci5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGJhbGRNb3VudGFpbnNJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvYmFsZC1tb3VudGFpbnMuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCB5b3NlbWl0ZVZhbGxleUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy95b3NlbWl0ZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgICAgbGluazogbGFnb0RpQnJhaWVzSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICAgICAgbGluazogdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgICAgbGluazogbGFrZUxvdWlzZUltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgICAgICBsaW5rOiBsYXRlbWFySW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgICBsaW5rOiBiYWxkTW91bnRhaW5zSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICAgICAgbGluazogeW9zZW1pdGVWYWxsZXlJbWFnZVxuICAgIH1cbl07XG5cbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbiAgICBmb3JtU2VsZWN0b3I6IFwiZm9ybVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgICBjYXJkc0xpc3Q6ICcuY2FyZHNfX2xpc3QnLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLXRlbXBsYXRlJyxcbiAgICBwcmV2aWV3UG9wdXA6ICcjaW1hZ2UtbW9kYWwnLFxuICAgIGVkaXRGb3JtUG9wdXA6ICcjZWRpdC1tb2RhbCcsXG4gICAgYWRkRm9ybVBvcHVwOiAnI2FkZC1tb2RhbCcsXG4gICAgcHJvZmlsZVRpdGxlOiAnLnByb2ZpbGVfX3RpdGxlJyxcbiAgICBwcm9maWxlRGVzY3JpcHRpb246ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nLFxuICAgIHByb2ZpbGVBdmF0YXI6ICcucHJvZmlsZV9fYXZhdGFyJyxcbiAgICBmb3JtTW9kYWxDb250YWluZXI6ICcubW9kYWxfX2NvbnRhaW5lcicsXG4gICAgaW1hZ2VNb2RhbENvbnRhaW5lcjogJy5tb2RhbF9fY29udGFpbmVyLWltYWdlJyxcbiAgICBjaGFuZ2VBdmF0YXJQb3B1cDogXCIjY2hhbmdlLWF2YXRhci1tb2RhbFwiLFxuICAgIGNvbmZpcm1EZWxldGVNb2RhbDogXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIixcbn07XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVMaWtlQ2FyZCwgaGFuZGxlRGVsZXRlLCBjdXJyZW50VXNlcklkKSB7XG4gICAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgICB0aGlzLl9pc0xpa2VkIC0gZGF0YS5pc0xpa2VkOyBcblxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XG4gICAgfVxuICAgIFxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcblxuICAgICAgLy9saWtlIGJ1dHRvblxuICAgICAgdGhpcy5saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgICAgdGhpcy5saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpO1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlKClcbiAgICAgIH0pO1xuXG4gICAgICAvL3RyYXNoIGJ1dHRvblxuICAgICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190cmFzaC1idXR0b24nKTtcbiAgICAgIHRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlKCkpO1xuXG4gICAgICAvL2ltYWdlIG1vZGFsIGNsaWNrXG4gICAgICB0aGlzLl9pbWFnZU1vZGFsID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcbiAgICAgIHRoaXMuX2ltYWdlTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHtsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lfSkpO1xuICAgIH1cblxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGRcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZUxpa2UoKSB7XG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBkZWxldGVDYXJkKCkge1xuICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICAgIH1cblxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICAgIGNhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG4gIH1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZighaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gICAgfVxuXG4gICAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICAgICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAvLyB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICAgIH1cblxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICAgICAgaWYoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICAgICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB9XG5cbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0T2JqZWN0ID0ge307XG5cbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgICAgIGlucHV0T2JqZWN0W2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBpbnB1dE9iamVjdDtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgICAgICBpZihpc0xvYWRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKVxuICAgICAgICBzdXBlci5jbG9zZSgpOyAgICAgICAgXG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25Db25maWcsIGluaXRpYWxDYXJkcywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFN0eWxlcyBmcm9tIFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuXG5jb25zdCBhZGROZXdDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zWydjYXJkLWZvcm0nXTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LmZvcm1zWydwcm9maWxlLWZvcm0nXTtcbmNvbnN0IHVwZGF0ZUF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1snYXZhdGFyLWZvcm0nXTtcblxuY29uc3QgZm9ybUlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLWlucHV0LW5hbWUnKTtcbmNvbnN0IGZvcm1JbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtaW5wdXQtZGVzY3JpcHRpb24nKTtcblxuLy9Vc2VySW5mb1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgIG5hbWVFbDogc2VsZWN0b3JzLnByb2ZpbGVUaXRsZSwgXG4gICAgZGVzY3JpcHRpb25FbDogc2VsZWN0b3JzLnByb2ZpbGVEZXNjcmlwdGlvbiwgXG4gICAgYXZhdGFyRWw6IHNlbGVjdG9ycy5wcm9maWxlQXZhdGFyLFxufSk7XG5cbi8vQVBJIFxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGF1dGhvcml6YXRpb246IFwiZDhlNjM1ZGMtYjlhMy00MGJiLThiOGEtNDRiMTE4YTJiMTA1XCIsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICB9LFxufSk7XG5cbmxldCBzZWN0aW9uO1xubGV0IGN1cnJlbnRVc2VySWQ7XG5cblByb21pc2UuYWxsKFthcGkuZmV0Y2hVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgICAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UodXNlckRhdGEuYXZhdGFyKTtcbiAgICAgICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0b3JzLmNhcmRzTGlzdFxuICAgICAgICApO1xuICAgICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xuXG4vL3JlbmRlcmluZyBjYXJkXG5jb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKGltYWdlRGF0YSkgPT4ge1xuICAgIHBvcHVwSW1hZ2Uub3BlbihpbWFnZURhdGEpXG59XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgZGF0YSwgXG4gICAgICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUsIFxuICAgICAgICBoYW5kbGVJbWFnZUNsaWNrLCBcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgaWYoZGF0YS5pc0xpa2VkKSB7XG4gICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUxpa2UoZGF0YS5faWQpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcGkuYWRkTGlrZShkYXRhLl9pZClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgY29uZmlybURlbGV0ZU1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbnRVc2VySWQpO1xuXG4gICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59O1xuXG4vLyB2YWxpZGF0aW9uXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGZvcm1WYWxpZGF0aW9uQ29uZmlnKSA9PiB7XG4gICAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZm9ybVZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpOyBcblxuICAgICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICAgIH0pO1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKGZvcm1WYWxpZGF0aW9uQ29uZmlnKTtcblxuLy8gQWRkaW5nIE5ldyBDYXJkIEZvcm0gaGFuZGxlclxuY29uc3QgaGFuZGxlQWRkQ2FyZFN1Ym1pdCA9IChkYXRhKSA9PiB7XG4gICAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGkuYWRkTmV3Q2FyZCh7XG4gICAgICAgIGNhcmROYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGNhcmRMaW5rOiBkYXRhLmxpbmssXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2FyZEVsID0gcmVuZGVyQ2FyZCh7XG4gICAgICAgICAgICAgICAgbmFtZTogY2FyZERhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBsaW5rOiBjYXJkRGF0YS5saW5rLFxuICAgICAgICAgICAgICAgIGlkOiBjYXJkRGF0YS5faWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XG4gICAgICAgICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBhZGRDYXJkRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfSk7XG59XG5cbi8vRWRpdCBQcm9maWxlIEZvcm0gaGFuZGxlclxuY29uc3QgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQgPSAoaW5wdXQpID0+IHtcbiAgICBlZGl0UHJvZmlsZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpLmVkaXRQcm9maWxlKGlucHV0KVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgICAgICAgbmFtZTogaW5wdXQubmFtZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaW5wdXQuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVkaXRQcm9maWxlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfSk7XG59XG5cbmNvbnN0IG9wZW5Qcm9maWxlTW9kYWwgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgICBmb3JtSW5wdXROYW1lLnZhbHVlID0gbmFtZTtcbiAgICBmb3JtSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IGRlc2NyaXB0aW9uO1xuICAgIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVFZGl0Rm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgZWRpdFByb2ZpbGVNb2RhbC5vcGVuKCk7XG59XG5cbi8vQ2hhbmdpbmcgYXZhdGFyIGhlbHBlclxuY29uc3QgaGFuZGxlVXBkYXRlQXZhdGFyID0gKGlucHV0KSA9PiB7XG4gICAgdXBkYXRlQXZhdGFyTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGkuZWRpdFByb2ZpbGVBdmF0YXIoaW5wdXQpXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICB1c2VySW5mby5zZXRBdmF0YXJJbWFnZShkYXRhLmF2YXRhcik7XG4gICAgICAgICAgICB1cGRhdGVBdmF0YXJNb2RhbC5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVBdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfSlcbn1cblxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcyBpbnN0YW50aWF0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxuXG4vL2NoYW5nZSBhdmF0YXJcbmNvbnN0IHVwZGF0ZUF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmNoYW5nZUF2YXRhclBvcHVwLCBoYW5kbGVVcGRhdGVBdmF0YXIpO1xudXBkYXRlQXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxucHJvZmlsZUF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICB1cGRhdGVBdmF0YXJNb2RhbC5vcGVuKCk7XG4gICAgZm9ybVZhbGlkYXRvcnNbdXBkYXRlQXZhdGFyRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KVxuXG4vL1BvcHVwV2l0aEltYWdlXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHNlbGVjdG9ycy5wcmV2aWV3UG9wdXApO1xucG9wdXBJbWFnZS5jbG9zZSgpO1xuXG4vL2RlbGV0ZSBtb2RhbFxuY29uc3QgY29uZmlybURlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm0oc2VsZWN0b3JzLmNvbmZpcm1EZWxldGVNb2RhbCk7XG5jb25maXJtRGVsZXRlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy9lZGl0IHByb2ZpbGVcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuZWRpdEZvcm1Qb3B1cCwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVNb2RhbClcblxuLy9hZGQgbmV3IGNhcmRcbmNvbnN0IGFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmFkZEZvcm1Qb3B1cCwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5hZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgZm9ybVZhbGlkYXRvcnNbYWRkTmV3Q2FyZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIGFkZENhcmRGb3JtLm9wZW4oKTtcbn0pIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHsgbmFtZUVsLCBkZXNjcmlwdGlvbkVsLCBhdmF0YXJFbCB9KSB7XG4gICAgICAgIHRoaXMuX25hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZUVsKTtcbiAgICAgICAgdGhpcy5fZGVzY3JpcHRpb25FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25FbCk7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhckVsKTtcbiAgICB9XG5cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWVFbC50ZXh0Q29udGVudCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbkVsLnRleHRDb250ZW50LFxuICAgICAgICAgICAgYXZhdGFyOiB0aGlzLl9saW5rLnNyYyxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICAgICAgICB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gICAgfVxuXG4gICAgc2V0QXZhdGFySW1hZ2UobGluaykge1xuICAgICAgICB0aGlzLl9saW5rLnNyYyA9IGxpbms7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICAgICAgdGhpcy5fdXJsID0gYmFzZVVybDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gICAgICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XG4gICAgfVxuXG4gICAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgICAgIGlmKHJlcy5vaykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvciAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfVxuXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuICAgICAgXG4gICAgZmV0Y2hVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBlZGl0UHJvZmlsZSh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICAgICAgfVxuXG4gICAgZWRpdFByb2ZpbGVBdmF0YXIoeyBsaW5rIH0pIHtcbiAgICAgICAgZGVidWdnZXJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gICAgfVxuXG4gICAgYWRkTmV3Q2FyZCh7IGNhcmROYW1lLCBjYXJkTGluayB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IFxuICAgICAgICAgICAgICAgIG5hbWU6IGNhcmROYW1lLCBcbiAgICAgICAgICAgICAgICBsaW5rOiBjYXJkTGluayxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBhZGRMaWtlKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG5cbiAgICBkZWxldGVMaWtlKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgICB9XG4gIH0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICAgIHRoaXMuX21vZGFsTmFtZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fbmFtZScpO1xuICAgICAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpO1xuXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgb3BlbihpbWFnZURhdGEpIHtcbiAgICAgICAgdGhpcy5fbW9kYWxOYW1lLnRleHRDb250ZW50ID0gaW1hZ2VEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2UuYWx0ID0gaW1hZ2VEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gaW1hZ2VEYXRhLmxpbms7XG5cbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTsgICAgICAgIFxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBkZWJ1Z2dlclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBhY3Rpb247XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibSIsIm8iLCJvYmoiLCJwcm9wIiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicCIsImIiLCJkb2N1bWVudCIsImJhc2VVUkkiLCJzZWxmIiwibG9jYXRpb24iLCJocmVmIiwiVVJMIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VDYXJkIiwiaGFuZGxlRGVsZXRlIiwiY3VycmVudFVzZXJJZCIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2N1cnJlbnRVc2VySWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJsaWtlQnV0dG9uIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlIiwiX2ltYWdlTW9kYWwiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJkZWxldGVDYXJkIiwicmVtb3ZlIiwiZ2VuZXJhdGVDYXJkIiwiY2FyZEltYWdlIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxlbWVudHMiLCJldmVyeSIsImRpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2Nsb3NlQnV0dG9uIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJldnQiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY2xvc2UiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfZm9ybSIsIl9mb3JtSW5wdXRzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfYnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0T2JqZWN0IiwiaW5wdXQiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJyZXNldCIsIlNlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsInByb2ZpbGVBdmF0YXIiLCJhZGROZXdDYXJkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwidXBkYXRlQXZhdGFyRm9ybSIsImZvcm1JbnB1dE5hbWUiLCJmb3JtSW5wdXREZXNjcmlwdGlvbiIsInVzZXJJbmZvIiwibmFtZUVsIiwiZGVzY3JpcHRpb25FbCIsImF2YXRhckVsIiwiX25hbWVFbCIsIl9kZXNjcmlwdGlvbkVsIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsImF2YXRhciIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJzZXRBdmF0YXJJbWFnZSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX3VybCIsIl9oZWFkZXJzIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZmV0Y2hVc2VySW5mbyIsImVkaXRQcm9maWxlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImVkaXRQcm9maWxlQXZhdGFyIiwiX3JlZjMiLCJhZGROZXdDYXJkIiwiX3JlZjQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwiY2FyZElkIiwiYWRkTGlrZSIsImRlbGV0ZUxpa2UiLCJzZWN0aW9uIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsImNhcmQiLCJyZW5kZXJDYXJkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiaW1hZ2VEYXRhIiwicG9wdXBJbWFnZSIsIkNhcmQiLCJjb25maXJtRGVsZXRlTW9kYWwiLCJzZXRTdWJtaXRBY3Rpb24iLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1WYWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJ1cGRhdGVBdmF0YXJNb2RhbCIsImVycm9yIiwiZmluYWxseSIsIl9tb2RhbE5hbWUiLCJfbW9kYWxJbWFnZSIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJhY3Rpb24iLCJlZGl0UHJvZmlsZU1vZGFsIiwib3BlblByb2ZpbGVNb2RhbCIsImFkZENhcmRGb3JtIiwiY2FyZERhdGEiLCJjYXJkRWwiXSwic291cmNlUm9vdCI6IiJ9