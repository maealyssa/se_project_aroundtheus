!function(){"use strict";var e={960:function(e,t,r){e.exports=r.p+"190142da37235e3079a8.jpg"},291:function(e,t,r){e.exports=r.p+"9aed7cb3f54c0faa1f9f.jpg"},822:function(e,t,r){e.exports=r.p+"0fb96793ab89da938a7d.jpg"},328:function(e,t,r){e.exports=r.p+"395d21149564d1293c88.jpg"},705:function(e,t,r){e.exports=r.p+"a22751dd8a0e22ceb5f6.jpg"},561:function(e,t,r){e.exports=r.p+"0df918d480d675e4708e.jpg"}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.m=e,r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.b=document.baseURI||self.location.href,function(){new URL(r(291),r.b),new URL(r(705),r.b),new URL(r(822),r.b),new URL(r(328),r.b),new URL(r(960),r.b),new URL(r(561),r.b);const e={cardsList:".cards__list",cardTemplate:"#card-template",previewPopup:"#image-modal",editFormPopup:"#edit-modal",addFormPopup:"#add-modal",profileTitle:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar",formModalContainer:".modal__container",imageModalContainer:".modal__container-image",formInputName:"#profile-input-name",formInputDescription:"#profile-input-description",changeAvatarPopup:"#change-avatar-modal",avatarForm:"#avatar-form",updateAvatarButton:"#modal-avatar-button"};var t=class{constructor(e,t,r,s,i){this._name=e.name,this._link=e.link,this._cardId=e._id,this._isLiked=e.isLiked,this._cardSelector=s,this._handleImageClick=t,this._handleDelete=r,this._setIsLiked=i}_setEventListeners(){this._likeButton=this._element.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>this._setIsLiked(this))),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>this._handleDelete)),this._imageModal=this._element.querySelector(".card__image"),this._imageModal.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_handleLike(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}isLiked(){return this._isLiked}deleteCard(){this._element.remove(),this._element=null}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._handleLike(),this._element}getCardId(){return this._cardId}};class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputList=this._formElement.querySelectorAll(this._inputSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this.disableButton()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class i{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".modal__close")}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class o extends i{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";super({popupSelector:e}),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button"),this._formInputs=this._popup.querySelectorAll("input"),this._handleFormSubmit=t,this._buttonText=this._submitButton.textContent,this._loadingText=r}showLoading(){this._buttonText=this._loadingText}hideLoading(){this._buttonText=this._buttonText}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{this._handleFormSubmit(this._getInputValues()),e.preventDefault()}))}close(){this._form.reset(),super.close()}}class n{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._cardSelector=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._cardSelector.prepend(e)}}const a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),d=document.forms["card-form"],c=document.forms["profile-form"],h=document.querySelector("#profile-input-name"),u=document.querySelector("#profile-input-description");let _;const m=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{e.ok?e.json():Promise.reject("An error has occurred",e.status)})).then((e=>e)).catch((e=>{console.error(e)}))}fetchUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{e.ok?e.json():Promise.reject("An error has occurred",e.status)})).then((e=>e)).catch((e=>{console.error(e)}))}editProfile(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}editProfileAvatar(e){let{link:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>{e.ok?e.json():Promise.reject("An error has occurred",e.status)})).then((e=>e)).catch((e=>{console.error(e)}))}addNewCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}deleteCard(e){let{cardId:t}=e;return fetch(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:this._headers})}addLike(e){let{cardId:t}=e;return fetch(`${this._baseUrl}/cards/likes/${t}`,{method:"PUT",headers:this._headers}).then((e=>{e.ok?e.json():Promise.reject("An error has occurred",e.status)})).then((e=>e)).catch((e=>{console.error(e)}))}deleteLike(e){let{cardId:t}=e;return fetch(`${this._baseUrl}/cards/${t}/likes`,{method:"DELETE",headers:this._headers}).then((e=>{e.ok?e.json():Promise.reject("An error has occurred",e.status)})).then((e=>e)).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"174196d6-45bd-490a-bc0e-39b0754c7da9","Content-Type":"application/json"}}),p={};var f;f={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(f.formSelector)).forEach((e=>{const t=new s(f,e),r=e.getAttribute("name");p[r]=t,t.enableValidation()}));const v=new class extends i{constructor(e){super({popupSelector:e}),this._modalName=this._popup.querySelector(".modal__name"),this._modalImage=this._popup.querySelector(".modal__image"),super.setEventListeners()}open(e){this._modalName.textContent=e.name,this._modalImage.alt=e.name,this._modalImage.src=e.link,super.open()}}(e.previewPopup);v.close();const b=r=>new t(r,L,handleDelete,e.cardTemplate,g).generateCard(),L=e=>{v.open(e)},g=e=>{e.isLiked()?m.deleteLike(e.getCardId()).then((t=>{e.setIsLiked(!1)})).catch((e=>{console.error(e)})):m.addLike(e.getCardId()).then((t=>{e.setIsLiked(!0)})).catch((e=>{console.error(e)}))},E=new class{constructor(e,t,r){this._nameEl=document.querySelector(e),this._descriptionEl=document.querySelector(t),this._link=document.querySelector(r)}getUserInfo(){return{name:this._nameEl.textContent,description:this._descriptionEl.textContent,avatar:this._link.src}}setUserInfo(e,t){this._nameEl.textContent=e,this._descriptionEl.textContent=t}setAvatarImage(e){this._link.src=e}}(e.profileTitle,e.profileDescription,e.profileAvatar);Promise.all([m.fetchUserInfo(),m.getInitialCards()]).then((t=>{let[r,s]=t;E.setUserInfo({name:r.name,description:r.about}),E.setAvatarImage(r.avatar),_=new n({items:s,renderer:e=>{const t=b(e);cardSection.addItem(t)}},e.cardsList),_.renderItems()})).catch((e=>{console.log(e)}));const k=new o(e.addFormPopup,S);l.addEventListener("click",(()=>{p[d.getAttribute("name")].resetValidation(),k.open()}));const S=e=>{k.showLoading();const{name:t,link:r}=e;return m.addNewCard(t,r).then((e=>{const t=b(e);_.addItem(t),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.hideLoading()}))},I=new o(e.editFormPopup,y);I.setEventListeners(),a.addEventListener("click",(()=>{const{name:e,description:t}=E.getUserInfo();h.value=e,u.value=t,p[c.getAttribute("name")].disableButton(),I.open()}));const y=e=>{let{title:t,description:r}=e;return I.showLoading(),m.editProfile(t,r).then((()=>{E.setUserInfo({name:t,description:r}),I.close()})).catch((e=>{console.error(e)})).finally((()=>{I.hideLoading()}))},C=new o(e.changeAvatarPopup,B);C.setEventListeners();const B=e=>{let{link:t}=e;return C.showLoading(),m.updateAvatar(t).then((e=>{E.setAvatarImage(e.avatar),C.close(),C.reset()})).catch((e=>{console.error(e)})).finally((()=>{C.hideLoading()}))};e.updateAvatarButton.addEventListener("click",(()=>{p[e.avatarForm.getAttribute("name")].resetValidation(),C.open()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoicVpBQ0lBLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQkUsSUFBakJELEVBQ0gsT0FBT0EsRUFBYUUsUUFHckIsSUFBSUMsRUFBU04sRUFBeUJFLEdBQVksQ0FHakRHLFFBQVMsQ0FBQyxHQU9YLE9BSEFFLEVBQW9CTCxHQUFVSSxFQUFRQSxFQUFPRCxRQUFTSixHQUcvQ0ssRUFBT0QsT0FDZixDQUdBSixFQUFvQk8sRUFBSUQsRUN6QnhCTixFQUFvQlEsRUFBSSxTQUFTQyxFQUFLQyxHQUFRLE9BQU9DLE9BQU9DLFVBQVVDLGVBQWVDLEtBQUtMLEVBQUtDLEVBQU8sRUNBdEdWLEVBQW9CZSxFQUFJLEdDQXhCZixFQUFvQmdCLEVBQUlDLFNBQVNDLFNBQVdDLEtBQUtDLFNBQVNDLEssV0NBaEMsSUFBSUMsSUFBSSxZQUNELElBQUlBLElBQUksWUFDakIsSUFBSUEsSUFBSSxZQUNYLElBQUlBLElBQUksWUFDRixJQUFJQSxJQUFJLFlBQ1AsSUFBSUEsSUFBSSxZQUxwQyxNQTJDYUMsRUFBWSxDQUNyQkMsVUFBVyxlQUNYQyxhQUFjLGlCQUNkQyxhQUFjLGVBQ2RDLGNBQWUsY0FDZkMsYUFBYyxhQUNkQyxhQUFjLGtCQUNkQyxtQkFBb0Isd0JBQ3BCQyxjQUFlLG1CQUNmQyxtQkFBb0Isb0JBQ3BCQyxvQkFBcUIsMEJBQ3JCQyxjQUFlLHNCQUNmQyxxQkFBc0IsNkJBQ3RCQyxrQkFBbUIsdUJBQ25CQyxXQUFZLGVBQ1pDLG1CQUFvQix3QkNheEIsTUF2RUEsTUFDRUMsV0FBQUEsQ0FBWUMsRUFBTUMsRUFBa0JDLEVBQWNDLEVBQWNDLEdBQzVEQyxLQUFLQyxNQUFRTixFQUFLTyxLQUNsQkYsS0FBS0csTUFBUVIsRUFBS1MsS0FDbEJKLEtBQUtLLFFBQVVWLEVBQUtXLElBQ3BCTixLQUFLTyxTQUFXWixFQUFLYSxRQUVyQlIsS0FBS1MsY0FBZ0JYLEVBQ3JCRSxLQUFLVSxrQkFBb0JkLEVBQ3pCSSxLQUFLVyxjQUFnQmQsRUFDckJHLEtBQUtZLFlBQWNiLENBQ3JCLENBRUFjLGtCQUFBQSxHQUdFYixLQUFLYyxZQUFjZCxLQUFLZSxTQUFTQyxjQUFjLHNCQUMvQ2hCLEtBQUtjLFlBQVlHLGlCQUFpQixTQUFTLElBQU1qQixLQUFLWSxZQUFZWixRQUc5Q0EsS0FBS2UsU0FBU0MsY0FBYyx1QkFDcENDLGlCQUFpQixTQUFTLElBQU1qQixLQUFLVyxnQkFHakRYLEtBQUtrQixZQUFjbEIsS0FBS2UsU0FBU0MsY0FBYyxnQkFDL0NoQixLQUFLa0IsWUFBWUQsaUJBQWlCLFNBQVMsSUFBTWpCLEtBQUtVLGtCQUFrQixDQUFDTixLQUFNSixLQUFLRyxNQUFPRCxLQUFNRixLQUFLQyxTQUN4RyxDQUVBa0IsWUFBQUEsR0FDRSxPQUFPL0MsU0FDTjRDLGNBQWNoQixLQUFLUyxlQUNuQlcsUUFBUUosY0FBYyxTQUN0QkssV0FBVSxFQUNiLENBRUFDLFdBQUFBLEdBQ0V0QixLQUFLTyxTQUNEUCxLQUFLYyxZQUFZUyxVQUFVQyxJQUFJLDRCQUMvQnhCLEtBQUtjLFlBQVlTLFVBQVVFLE9BQU8sMkJBQ3hDLENBRUFqQixPQUFBQSxHQUNFLE9BQU9SLEtBQUtPLFFBQ2QsQ0FFQW1CLFVBQUFBLEdBQ0UxQixLQUFLZSxTQUFTVSxTQUNkekIsS0FBS2UsU0FBVyxJQUNsQixDQUVBWSxZQUFBQSxHQUNFM0IsS0FBS2UsU0FBV2YsS0FBS21CLGVBRXJCLE1BQU1TLEVBQVk1QixLQUFLZSxTQUFTQyxjQUFjLGdCQVU5QyxPQVRBWSxFQUFVQyxJQUFNN0IsS0FBS0csTUFDckJ5QixFQUFVRSxJQUFNOUIsS0FBS0MsTUFFSEQsS0FBS2UsU0FBU0MsY0FBYyxnQkFDcENlLFlBQWMvQixLQUFLQyxNQUU3QkQsS0FBS2EscUJBQ0xiLEtBQUtzQixjQUVFdEIsS0FBS2UsUUFDZCxDQUVBaUIsU0FBQUEsR0FDRSxPQUFPaEMsS0FBS0ssT0FDZCxHQ3BFVyxNQUFNNEIsRUFDakJ2QyxXQUFBQSxDQUFZd0MsRUFBUUMsR0FDaEJuQyxLQUFLb0MsZUFBaUJGLEVBQU9HLGNBQzdCckMsS0FBS3NDLHNCQUF3QkosRUFBT0sscUJBQ3BDdkMsS0FBS3dDLHFCQUF1Qk4sRUFBT08sb0JBQ25DekMsS0FBSzBDLGlCQUFtQlIsRUFBT1MsZ0JBQy9CM0MsS0FBSzRDLFlBQWNWLEVBQU9XLFdBRTFCN0MsS0FBSzhDLGFBQWVYLEVBQ3BCbkMsS0FBSytDLFdBQWEvQyxLQUFLOEMsYUFBYUUsaUJBQWlCaEQsS0FBS29DLGVBQzlELENBRUFhLGVBQUFBLENBQWdCQyxHQUNaLE1BQU1DLEVBQXNCbkQsS0FBSzhDLGFBQWE5QixjQUFjLElBQUlrQyxFQUFhRSxZQUM3RUYsRUFBYTNCLFVBQVVDLElBQUl4QixLQUFLMEMsa0JBQ2hDUyxFQUFvQnBCLFlBQWNtQixFQUFhRyxrQkFDL0NGLEVBQW9CNUIsVUFBVUMsSUFBSXhCLEtBQUs0QyxZQUMzQyxDQUVBVSxlQUFBQSxDQUFnQkosR0FDWixNQUFNQyxFQUFzQm5ELEtBQUs4QyxhQUFhOUIsY0FBYyxJQUFJa0MsRUFBYUUsWUFDN0VGLEVBQWEzQixVQUFVRSxPQUFPekIsS0FBSzBDLGtCQUNuQ1MsRUFBb0JwQixZQUFjLEdBQ2xDb0IsRUFBb0I1QixVQUFVRSxPQUFPekIsS0FBSzRDLFlBQzlDLENBRUFXLG1CQUFBQSxDQUFvQkwsR0FDWkEsRUFBYU0sU0FBU0MsTUFHdEJ6RCxLQUFLc0QsZ0JBQWdCSixHQUZyQmxELEtBQUtpRCxnQkFBZ0JDLEVBSTdCLENBRUFRLGdCQUFBQSxHQUNJLE9BQVExRCxLQUFLMkQsZUFBZUMsT0FBT1YsR0FBaUJBLEVBQWFNLFNBQVNDLE9BQzlFLENBRUFJLGFBQUFBLEdBQ0k3RCxLQUFLOEQsY0FBY3ZDLFVBQVVDLElBQUl4QixLQUFLd0Msc0JBQ3RDeEMsS0FBSzhELGNBQWNDLFVBQVcsQ0FDbEMsQ0FFQUMsYUFBQUEsR0FDSWhFLEtBQUs4RCxjQUFjdkMsVUFBVUUsT0FBT3pCLEtBQUt3QyxzQkFDekN4QyxLQUFLOEQsY0FBY0MsVUFBVyxDQUNsQyxDQUVBRSxrQkFBQUEsR0FDT2pFLEtBQUswRCxtQkFDSjFELEtBQUs2RCxnQkFFTDdELEtBQUtnRSxlQUViLENBRUFuRCxrQkFBQUEsR0FDSWIsS0FBSzJELGVBQWlCLElBQUkzRCxLQUFLOEMsYUFBYUUsaUJBQWlCaEQsS0FBS29DLGlCQUNsRXBDLEtBQUs4RCxjQUFnQjlELEtBQUs4QyxhQUFhOUIsY0FBY2hCLEtBQUtzQyx1QkFFMUR0QyxLQUFLMkQsZUFBZU8sU0FBUWhCLElBQ3hCQSxFQUFhakMsaUJBQWlCLFNBQVMsS0FDbkNqQixLQUFLdUQsb0JBQW9CTCxHQUN6QmxELEtBQUtpRSxvQkFBb0IsR0FDM0IsR0FFVixDQUVBRSxnQkFBQUEsR0FDSW5FLEtBQUs4QyxhQUFhN0IsaUJBQWlCLFVBQVdtRCxJQUMxQ0EsRUFBRUMsaUJBQ0ZyRSxLQUFLNkQsZUFBZSxJQUd4QjdELEtBQUthLG9CQUNULENBRUF5RCxlQUFBQSxHQUNJdEUsS0FBS2lFLHFCQUVMakUsS0FBSytDLFdBQVdtQixTQUFTaEIsSUFDckJsRCxLQUFLc0QsZ0JBQWdCSixFQUFhLEdBRTFDLEVDbkZXLE1BQU1xQixFQUNqQjdFLFdBQUFBLENBQVc4RSxHQUFvQixJQUFuQixjQUFFQyxHQUFlRCxFQUN6QnhFLEtBQUswRSxPQUFTdEcsU0FBUzRDLGNBQWN5RCxHQUNyQ3pFLEtBQUsyRSxhQUFlM0UsS0FBSzBFLE9BQU8xRCxjQUFjLGdCQUNsRCxDQUVBNEQsaUJBQUFBLEdBQ0k1RSxLQUFLMEUsT0FBT3pELGlCQUFpQixTQUFVNEQsSUFDL0JBLEVBQUlDLFNBQVdELEVBQUlFLGVBQ25CL0UsS0FBS2dGLE9BQ1QsSUFHSmhGLEtBQUsyRSxhQUFhMUQsaUJBQWlCLFNBQVMsSUFBTWpCLEtBQUtnRixTQUMzRCxDQUVBQyxJQUFBQSxHQUNJakYsS0FBSzBFLE9BQU9uRCxVQUFVQyxJQUFJLGdCQUMxQnBELFNBQVM2QyxpQkFBaUIsVUFBV2pCLEtBQUtrRixnQkFDOUMsQ0FFQUYsS0FBQUEsR0FDSWhGLEtBQUswRSxPQUFPbkQsVUFBVUUsT0FBTyxnQkFDN0JyRCxTQUFTK0csb0JBQW9CLFVBQVduRixLQUFLa0YsZ0JBQ2pELENBRUFBLGdCQUFtQkwsSUFDQSxXQUFaQSxFQUFJTyxLQUNIcEYsS0FBS2dGLE9BQ1QsRUMzQk8sTUFBTUssVUFBc0JkLEVBQ3ZDN0UsV0FBQUEsQ0FBWStFLEVBQWVhLEdBQTZDLElBQTNCQyxFQUFXQyxVQUFBQyxPQUFBLFFBQUFuSSxJQUFBa0ksVUFBQSxHQUFBQSxVQUFBLEdBQUcsWUFDdkRFLE1BQU0sQ0FBRWpCLGtCQUNSekUsS0FBSzJGLE1BQVEzRixLQUFLMEUsT0FBTzFELGNBQWMsZ0JBQ3ZDaEIsS0FBSzhELGNBQWdCOUQsS0FBSzBFLE9BQU8xRCxjQUFjLGtCQUMvQ2hCLEtBQUs0RixZQUFjNUYsS0FBSzBFLE9BQU8xQixpQkFBaUIsU0FDaERoRCxLQUFLNkYsa0JBQW9CUCxFQUN6QnRGLEtBQUs4RixZQUFjOUYsS0FBSzhELGNBQWMvQixZQUN0Qy9CLEtBQUsrRixhQUFlUixDQUN4QixDQUVBUyxXQUFBQSxHQUNJaEcsS0FBSzhGLFlBQWM5RixLQUFLK0YsWUFDNUIsQ0FFQUUsV0FBQUEsR0FDSWpHLEtBQUs4RixZQUFjOUYsS0FBSzhGLFdBQzVCLENBRUFJLGVBQUFBLEdBQ0ksTUFBTUMsRUFBYyxDQUFDLEVBTXJCLE9BSkFuRyxLQUFLNEYsWUFBWTFCLFNBQVFrQyxJQUNyQkQsRUFBWUMsRUFBTWxHLE1BQVFrRyxFQUFNQyxLQUFLLElBR2xDRixDQUNYLENBRUF2QixpQkFBQUEsR0FDSWMsTUFBTWQsb0JBRU41RSxLQUFLMEUsT0FBT3pELGlCQUFpQixVQUFXNEQsSUFDcEM3RSxLQUFLNkYsa0JBQWtCN0YsS0FBS2tHLG1CQUM1QnJCLEVBQUlSLGdCQUFnQixHQUU1QixDQUVBVyxLQUFBQSxHQUNJaEYsS0FBSzJGLE1BQU1XLFFBQ1haLE1BQU1WLE9BQ1YsRUMzQ1csTUFBTXVCLEVBQ2pCN0csV0FBQUEsQ0FBVzhFLEVBQXNCMUUsR0FBYyxJQUFuQyxNQUFFMEcsRUFBSyxTQUFFQyxHQUFVakMsRUFDM0J4RSxLQUFLMEcsT0FBU0YsRUFDZHhHLEtBQUsyRyxVQUFZRixFQUNqQnpHLEtBQUtTLGNBQWdCckMsU0FBUzRDLGNBQWNsQixFQUNoRCxDQUVBOEcsV0FBQUEsR0FDSTVHLEtBQUswRyxPQUFPeEMsU0FBUTJDLElBQ2hCN0csS0FBSzJHLFVBQVVFLEVBQUssR0FFNUIsQ0FFQUMsT0FBQUEsQ0FBUUMsR0FDSi9HLEtBQUtTLGNBQWN1RyxRQUFRRCxFQUMvQixFQ0hKLE1BQU1FLEVBQWE3SSxTQUFTNEMsY0FBYyx5QkFDcENrRyxFQUFZOUksU0FBUzRDLGNBQWMsd0JBRW5DbUcsRUFBaUIvSSxTQUFTZ0osTUFBTSxhQUNoQ0MsRUFBa0JqSixTQUFTZ0osTUFBTSxnQkFFakNFLEVBQW1CbEosU0FBUzRDLGNBQWMsdUJBQzFDdUcsRUFBMEJuSixTQUFTNEMsY0FBYyw4QkFFdkQsSUFBSXdHLEVBR0osTUFBTUMsRUFBTSxJQ3hCRyxNQUNYL0gsV0FBQUEsQ0FBVzhFLEdBQXVCLElBQXRCLFFBQUVrRCxFQUFPLFFBQUVDLEdBQVNuRCxFQUM1QnhFLEtBQUs0SCxTQUFXRixFQUNoQjFILEtBQUs2SCxTQUFXRixDQUNwQixDQUVBRyxlQUFBQSxHQUNJLE9BQU9DLE1BQU0sR0FBRy9ILEtBQUs0SCxpQkFBa0IsQ0FDbkNELFFBQVMzSCxLQUFLNkgsV0FFYkcsTUFBTUMsSUFDSEEsRUFBSUMsR0FDRUQsRUFBSUUsT0FDSkMsUUFBUUMsT0FBTyx3QkFBeUJKLEVBQUlLLE9BQU8sSUFFNUROLE1BQU1DLEdBQWdCQSxJQUN0Qk0sT0FBT0MsSUFDSkMsUUFBUUMsTUFBTUYsRUFBSSxHQUc5QixDQUVBRyxhQUFBQSxHQUNJLE9BQU9aLE1BQU0sR0FBRy9ILEtBQUs0SCxvQkFBcUIsQ0FDdENELFFBQVMzSCxLQUFLNkgsV0FFakJHLE1BQU1DLElBQ0hBLEVBQUlDLEdBQ0VELEVBQUlFLE9BQ0pDLFFBQVFDLE9BQU8sd0JBQXlCSixFQUFJSyxPQUFPLElBRTVETixNQUFNQyxHQUFnQkEsSUFDdEJNLE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksR0FHMUIsQ0FFQUksV0FBQUEsQ0FBV0MsR0FBa0IsSUFBakIsS0FBRTNJLEVBQUksTUFBRTRJLEdBQU9ELEVBQ3ZCLE9BQU9kLE1BQU0sR0FBRy9ILEtBQUs0SCxvQkFBcUIsQ0FDdENtQixPQUFRLFFBQ1JwQixRQUFTM0gsS0FBSzZILFNBQ2RtQixLQUFNQyxLQUFLQyxVQUFVLENBQ2pCaEosS0FBTUEsRUFDTjRJLE1BQU9BLEtBR25CLENBRUFLLGlCQUFBQSxDQUFpQkMsR0FBVyxJQUFWLEtBQUVoSixHQUFNZ0osRUFDdEIsT0FBT3JCLE1BQU0sR0FBRy9ILEtBQUs0SCwyQkFBNEIsQ0FDN0NtQixPQUFRLFFBQ1JwQixRQUFTM0gsS0FBSzZILFNBQ2RtQixLQUFNQyxLQUFLQyxVQUFVLENBQUVHLE9BQVFqSixNQUVsQzRILE1BQU1DLElBQ0hBLEVBQUlDLEdBQ0VELEVBQUlFLE9BQ0pDLFFBQVFDLE9BQU8sd0JBQXlCSixFQUFJSyxPQUFPLElBRTVETixNQUFNQyxHQUFnQkEsSUFDdEJNLE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksR0FFMUIsQ0FFQWMsVUFBQUEsQ0FBVUMsR0FBaUIsSUFBaEIsS0FBRXJKLEVBQUksS0FBRUUsR0FBTW1KLEVBQ3JCLE9BQU94QixNQUFNLEdBQUcvSCxLQUFLNEgsaUJBQWtCLENBQ25DbUIsT0FBUSxPQUNScEIsUUFBUzNILEtBQUs2SCxTQUNkbUIsS0FBTUMsS0FBS0MsVUFBVSxDQUFFaEosT0FBTUUsVUFFckMsQ0FFQXNCLFVBQUFBLENBQVU4SCxHQUFhLElBQVosT0FBRUMsR0FBUUQsRUFDakIsT0FBT3pCLE1BQU0sR0FBRy9ILEtBQUs0SCxrQkFBa0I2QixJQUFVLENBQzdDVixPQUFRLFNBQ1JwQixRQUFTM0gsS0FBSzZILFVBRXRCLENBRUE2QixPQUFBQSxDQUFPQyxHQUFhLElBQVosT0FBRUYsR0FBUUUsRUFDZCxPQUFPNUIsTUFBTSxHQUFHL0gsS0FBSzRILHdCQUF3QjZCLElBQVUsQ0FDbkRWLE9BQVEsTUFDUnBCLFFBQVMzSCxLQUFLNkgsV0FFakJHLE1BQU1DLElBQ0hBLEVBQUlDLEdBQ0VELEVBQUlFLE9BQ0pDLFFBQVFDLE9BQU8sd0JBQXlCSixFQUFJSyxPQUFPLElBRTVETixNQUFNQyxHQUFnQkEsSUFDdEJNLE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksR0FFMUIsQ0FFQW9CLFVBQUFBLENBQVVDLEdBQWEsSUFBWixPQUFFSixHQUFRSSxFQUNqQixPQUFPOUIsTUFBTSxHQUFHL0gsS0FBSzRILGtCQUFrQjZCLFVBQWdCLENBQ25EVixPQUFRLFNBQ1JwQixRQUFTM0gsS0FBSzZILFdBRWpCRyxNQUFNQyxJQUNIQSxFQUFJQyxHQUNFRCxFQUFJRSxPQUNKQyxRQUFRQyxPQUFPLHdCQUF5QkosRUFBSUssT0FBTyxJQUU1RE4sTUFBTUMsR0FBZ0JBLElBQ3RCTSxPQUFPQyxJQUNKQyxRQUFRQyxNQUFNRixFQUFJLEdBRTFCLEdEdkZnQixDQUNoQmQsUUFBUyxrREFDVEMsUUFBUyxDQUNQbUMsY0FBZSx1Q0FDZixlQUFnQixzQkFLaEJDLEVBQWlCLENBQUMsRUFFRUMsUU5EVSxDQUNoQzNILGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksdUJBQ1pvSCxhQUFjLFFNSkdDLE1BQU1DLEtBQUsvTCxTQUFTNEUsaUJBQWlCZ0gsRUFBcUJDLGVBRWxFL0YsU0FBUy9CLElBQ2YsTUFBTWlJLEVBQVksSUFBSW5JLEVBQWMrSCxFQUFzQjdILEdBQ3BEa0ksRUFBV2xJLEVBQVltSSxhQUFhLFFBRTFDUCxFQUFlTSxHQUFZRCxFQUMzQkEsRUFBVWpHLGtCQUFrQixJQU9uQyxNQUFNb0csRUFBYSxJRWhESixjQUE2QmhHLEVBQ3hDN0UsV0FBQUEsQ0FBWStFLEdBQ1JpQixNQUFNLENBQUVqQixrQkFDUnpFLEtBQUt3SyxXQUFheEssS0FBSzBFLE9BQU8xRCxjQUFjLGdCQUM1Q2hCLEtBQUt5SyxZQUFjekssS0FBSzBFLE9BQU8xRCxjQUFjLGlCQUU3QzBFLE1BQU1kLG1CQUNWLENBRUFLLElBQUFBLENBQUt5RixHQUNEMUssS0FBS3dLLFdBQVd6SSxZQUFjMkksRUFBVXhLLEtBQ3hDRixLQUFLeUssWUFBWTNJLElBQU00SSxFQUFVeEssS0FDakNGLEtBQUt5SyxZQUFZNUksSUFBTTZJLEVBQVV0SyxLQUVqQ3NGLE1BQU1ULE1BQ1YsR0ZpQ2tDdkcsRUFBVUcsY0FDaEQwTCxFQUFXdkYsUUFHWCxNQUFNMkYsRUFBY2hMLEdBQ0gsSUFBSWlMLEVBQUtqTCxFQUFNQyxFQUFrQkMsYUFBY25CLEVBQVVFLGFBQWNtQixHQUV4RTRCLGVBR1YvQixFQUFvQjhLLElBQ3RCSCxFQUFXdEYsS0FBS3lGLEVBQVUsRUFHeEIzSyxFQUFjOEssSUFDaEJBLEVBQUtySyxVQUNDaUgsRUFBSW1DLFdBQVdpQixFQUFLN0ksYUFDakJnRyxNQUFNQyxJQUNINEMsRUFBSzlLLFlBQVcsRUFBTSxJQUV6QndJLE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksSUFFeEJmLEVBQUlpQyxRQUFRbUIsRUFBSzdJLGFBQ2RnRyxNQUFNQyxJQUNINEMsRUFBSzlLLFlBQVcsRUFBSyxJQUV4QndJLE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksR0FDcEIsRUFJUnNDLEVBQVcsSUduRkYsTUFDWHBMLFdBQUFBLENBQVlxTCxFQUFRQyxFQUFlQyxHQUMvQmpMLEtBQUtrTCxRQUFVOU0sU0FBUzRDLGNBQWMrSixHQUN0Qy9LLEtBQUttTCxlQUFpQi9NLFNBQVM0QyxjQUFjZ0ssR0FDN0NoTCxLQUFLRyxNQUFRL0IsU0FBUzRDLGNBQWNpSyxFQUN4QyxDQUVBRyxXQUFBQSxHQUNJLE1BQU8sQ0FDSGxMLEtBQU1GLEtBQUtrTCxRQUFRbkosWUFDbkJzSixZQUFhckwsS0FBS21MLGVBQWVwSixZQUNqQ3NILE9BQVFySixLQUFLRyxNQUFNMEIsSUFFM0IsQ0FFQXlKLFdBQUFBLENBQVlwTCxFQUFNbUwsR0FDZHJMLEtBQUtrTCxRQUFRbkosWUFBYzdCLEVBQzNCRixLQUFLbUwsZUFBZXBKLFlBQWNzSixDQUN0QyxDQUVBRSxjQUFBQSxDQUFlbkwsR0FDWEosS0FBS0csTUFBTTBCLElBQU16QixDQUNyQixHSDZEMEIxQixFQUFVTSxhQUFjTixFQUFVTyxtQkFBb0JQLEVBQVVRLGVBRzlGa0osUUFBUW9ELElBQUksQ0FBQy9ELEVBQUlrQixnQkFBaUJsQixFQUFJSyxvQkFDakNFLE1BQUt4RCxJQUF1QixJQUFyQmlILEVBQVVDLEdBQU1sSCxFQUNwQnNHLEVBQVNRLFlBQVksQ0FDakJwTCxLQUFNdUwsRUFBU3ZMLEtBQ2ZtTCxZQUFhSSxFQUFTM0MsUUFFMUJnQyxFQUFTUyxlQUFlRSxFQUFTcEMsUUFDakM3QixFQUFVLElBQUlqQixFQUNWLENBQ0lDLE1BQU9rRixFQUNQakYsU0FBVzlHLElBQ1AsTUFBTWdNLEVBQVNoQixFQUFXaEwsR0FDMUJpTSxZQUFZOUUsUUFBUTZFLEVBQU8sR0FHbkNqTixFQUFVQyxXQUVkNkksRUFBUVosYUFBYSxJQUV4QjJCLE9BQU9DLElBQ0pDLFFBQVFvRCxJQUFJckQsRUFBSSxJQUl4QixNQUFNc0QsRUFBYyxJQUFJekcsRUFBYzNHLEVBQVVLLGFBQWNnTixHQUU5RDdFLEVBQVVqRyxpQkFBaUIsU0FBUyxLQUNoQzhJLEVBQWU1QyxFQUFlbUQsYUFBYSxTQUFTaEcsa0JBQ3BEd0gsRUFBWTdHLE1BQU0sSUFHdEIsTUFBTThHLEVBQXVCcE0sSUFDekJtTSxFQUFZOUYsY0FDWixNQUFNLEtBQUU5RixFQUFJLEtBQUVFLEdBQVNULEVBQ3ZCLE9BQU84SCxFQUFJNkIsV0FBV3BKLEVBQU1FLEdBQ3ZCNEgsTUFBTXJJLElBQ0gsTUFBTWdNLEVBQVNoQixFQUFXaEwsR0FDMUI2SCxFQUFRVixRQUFRNkUsR0FDaEJHLEVBQVk5RyxPQUFPLElBRXRCdUQsT0FBT0MsSUFDSkMsUUFBUW9ELElBQUlyRCxFQUFJLElBRW5Cd0QsU0FBUSxLQUNMRixFQUFZN0YsYUFBYSxHQUMzQixFQUlKZ0csRUFBbUIsSUFBSTVHLEVBQWMzRyxFQUFVSSxjQUFlb04sR0FDcEVELEVBQWlCckgsb0JBRWpCcUMsRUFBV2hHLGlCQUFpQixTQUFTLEtBQ2pDLE1BQU0sS0FBRWYsRUFBSSxZQUFFbUwsR0FBZ0JQLEVBQVNNLGNBQ3ZDOUQsRUFBaUJqQixNQUFRbkcsRUFDekJxSCxFQUF3QmxCLE1BQVFnRixFQUNoQ3RCLEVBQWUxQyxFQUFnQmlELGFBQWEsU0FBU3pHLGdCQUNyRG9JLEVBQWlCaEgsTUFBTSxJQUczQixNQUFNaUgsRUFBMEJyRCxJQUE0QixJQUEzQixNQUFFc0QsRUFBSyxZQUFFZCxHQUFheEMsRUFFbkQsT0FEQW9ELEVBQWlCakcsY0FDVnlCLEVBQUltQixZQUFZdUQsRUFBT2QsR0FDekJyRCxNQUFLLEtBQ0Y4QyxFQUFTUSxZQUFZLENBQUVwTCxLQUFNaU0sRUFBT2QsWUFBYUEsSUFDakRZLEVBQWlCakgsT0FBTyxJQUUzQnVELE9BQU9DLElBQ0pDLFFBQVFDLE1BQU1GLEVBQUksSUFFckJ3RCxTQUFRLEtBQ0xDLEVBQWlCaEcsYUFBYSxHQUNoQyxFQUtKbUcsRUFBb0IsSUFBSS9HLEVBQWMzRyxFQUFVYSxrQkFBbUI4TSxHQUN6RUQsRUFBa0J4SCxvQkFFbEIsTUFBTXlILEVBQXFCakQsSUFBYyxJQUFiLEtBQUVoSixHQUFNZ0osRUFFaEMsT0FEQWdELEVBQWtCcEcsY0FDWHlCLEVBQUk2RSxhQUFhbE0sR0FDbkI0SCxNQUFNckksSUFDSG1MLEVBQVNTLGVBQWU1TCxFQUFLMEosUUFDN0IrQyxFQUFrQnBILFFBQ2xCb0gsRUFBa0I5RixPQUFPLElBRTVCaUMsT0FBT0MsSUFDSkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVyQndELFNBQVEsS0FDTEksRUFBa0JuRyxhQUFhLEdBQ2pDLEVBR1Z2SCxFQUFVZSxtQkFBbUJ3QixpQkFBaUIsU0FBUyxLQUNuRDhJLEVBQWVyTCxFQUFVYyxXQUFXOEssYUFBYSxTQUFTaEcsa0JBQzFEOEgsRUFBa0JuSCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmlwbGV0ZW4vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3RyaXBsZXRlbi93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vdHJpcGxldGVuLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3RyaXBsZXRlbi8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly90cmlwbGV0ZW4vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iaiwgcHJvcCkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7IH0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIl9fd2VicGFja19yZXF1aXJlX18uYiA9IGRvY3VtZW50LmJhc2VVUkkgfHwgc2VsZi5sb2NhdGlvbi5ocmVmO1xuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuLy8gbm8gY2h1bmsgb24gZGVtYW5kIGxvYWRpbmdcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG4vLyBubyBqc29ucCBmdW5jdGlvbiIsImNvbnN0IGxhZ29EaUJyYWllc0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWdvLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy92YW5vaXNlLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgbGFrZUxvdWlzZUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9sYWtlLWxvdWlzZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGxhdGVtYXJJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGF0ZW1hci5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGJhbGRNb3VudGFpbnNJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvYmFsZC1tb3VudGFpbnMuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCB5b3NlbWl0ZVZhbGxleUltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy95b3NlbWl0ZS5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgICAgbGluazogbGFnb0RpQnJhaWVzSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICAgICAgbGluazogdmFub2lzZU5hdGlvbmFsUGFya0ltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgICAgbGluazogbGFrZUxvdWlzZUltYWdlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgICAgICBsaW5rOiBsYXRlbWFySW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgICBsaW5rOiBiYWxkTW91bnRhaW5zSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICAgICAgbGluazogeW9zZW1pdGVWYWxsZXlJbWFnZVxuICAgIH1cbl07XG5cbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbiAgICBmb3JtU2VsZWN0b3I6IFwiZm9ybVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgICBjYXJkc0xpc3Q6ICcuY2FyZHNfX2xpc3QnLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLXRlbXBsYXRlJyxcbiAgICBwcmV2aWV3UG9wdXA6ICcjaW1hZ2UtbW9kYWwnLFxuICAgIGVkaXRGb3JtUG9wdXA6ICcjZWRpdC1tb2RhbCcsXG4gICAgYWRkRm9ybVBvcHVwOiAnI2FkZC1tb2RhbCcsXG4gICAgcHJvZmlsZVRpdGxlOiAnLnByb2ZpbGVfX3RpdGxlJyxcbiAgICBwcm9maWxlRGVzY3JpcHRpb246ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nLFxuICAgIHByb2ZpbGVBdmF0YXI6ICcucHJvZmlsZV9fYXZhdGFyJyxcbiAgICBmb3JtTW9kYWxDb250YWluZXI6ICcubW9kYWxfX2NvbnRhaW5lcicsXG4gICAgaW1hZ2VNb2RhbENvbnRhaW5lcjogJy5tb2RhbF9fY29udGFpbmVyLWltYWdlJyxcbiAgICBmb3JtSW5wdXROYW1lOiAnI3Byb2ZpbGUtaW5wdXQtbmFtZScsXG4gICAgZm9ybUlucHV0RGVzY3JpcHRpb246ICcjcHJvZmlsZS1pbnB1dC1kZXNjcmlwdGlvbicsXG4gICAgY2hhbmdlQXZhdGFyUG9wdXA6IFwiI2NoYW5nZS1hdmF0YXItbW9kYWxcIixcbiAgICBhdmF0YXJGb3JtOiBcIiNhdmF0YXItZm9ybVwiLFxuICAgIHVwZGF0ZUF2YXRhckJ1dHRvbjogXCIjbW9kYWwtYXZhdGFyLWJ1dHRvblwiLFxufTtcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGUsIGNhcmRTZWxlY3Rvciwgc2V0SXNMaWtlZCkge1xuICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcbiAgICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG5cbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlID0gaGFuZGxlRGVsZXRlO1xuICAgICAgdGhpcy5fc2V0SXNMaWtlZCA9IHNldElzTGlrZWQ7XG4gICAgfVxuICAgIFxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcblxuICAgICAgLy9saWtlIGJ1dHRvblxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9zZXRJc0xpa2VkKHRoaXMpKTtcblxuICAgICAgLy90cmFzaCBidXR0b25cbiAgICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdHJhc2gtYnV0dG9uJyk7XG4gICAgICB0cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZSk7XG5cbiAgICAgIC8vaW1hZ2UgbW9kYWwgY2xpY2tcbiAgICAgIHRoaXMuX2ltYWdlTW9kYWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xuICAgICAgdGhpcy5faW1hZ2VNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe2xpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWV9KSk7XG4gICAgfVxuXG4gICAgX2dldFRlbXBsYXRlKCkge1xuICAgICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgfVxuXG4gICAgX2hhbmRsZUxpa2UoKSB7XG4gICAgICB0aGlzLl9pc0xpa2VkIFxuICAgICAgICA/IHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKSBcbiAgICAgICAgOiB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIilcbiAgICB9XG5cbiAgICBpc0xpa2VkKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XG4gICAgfVxuXG4gICAgZGVsZXRlQ2FyZCgpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcblxuICAgICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2UoKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gICAgfVxuXG4gICAgZ2V0Q2FyZElkKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhcmRJZDtcbiAgICB9XG4gIH1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZighaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gICAgfVxuXG4gICAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICAgICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICAgIH1cblxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXG4gICAgICAgIH0pO1xuICAgIH1cblxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICAgICAgaWYoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Zvcm0nKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKTtcbiAgICAgICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgICAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICAgICAgICB0aGlzLl9sb2FkaW5nVGV4dCA9IGxvYWRpbmdUZXh0O1xuICAgIH1cblxuICAgIHNob3dMb2FkaW5nKCkge1xuICAgICAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fbG9hZGluZ1RleHQ7XG4gICAgfVxuXG4gICAgaGlkZUxvYWRpbmcoKSB7XG4gICAgICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgIH1cblxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAgICAgY29uc3QgaW5wdXRPYmplY3QgPSB7fTtcblxuICAgICAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgaW5wdXRPYmplY3RbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gaW5wdXRPYmplY3Q7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7ICAgICAgICBcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2FyZFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICByZW5kZXJJdGVtcygpIHtcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IucHJlcGVuZChlbGVtZW50KTtcbiAgICB9XG59IiwiaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25Db25maWcsIGluaXRpYWxDYXJkcywgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFN0eWxlcyBmcm9tIFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5cbmNvbnN0IGFkZE5ld0NhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2NhcmQtZm9ybSddO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb2ZpbGUtZm9ybSddO1xuXG5jb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtaW5wdXQtbmFtZScpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZS1pbnB1dC1kZXNjcmlwdGlvbicpO1xuXG5sZXQgc2VjdGlvbjtcblxuLy9BUEkgXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gICAgaGVhZGVyczoge1xuICAgICAgYXV0aG9yaXphdGlvbjogXCIxNzQxOTZkNi00NWJkLTQ5MGEtYmMwZS0zOWIwNzU0YzdkYTlcIixcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgfVxufSk7XG5cbi8vIHZhbGlkYXRpb25cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoZm9ybVZhbGlkYXRpb25Db25maWcpID0+IHtcbiAgICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChmb3JtVmFsaWRhdGlvbkNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcblxuICAgIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25Db25maWcsIGZvcm1FbGVtZW50KTtcbiAgICAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7IFxuXG4gICAgICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gICAgfSk7XG59XG5cbmVuYWJsZVZhbGlkYXRpb24oZm9ybVZhbGlkYXRpb25Db25maWcpO1xuXG4vL1BvcHVwV2l0aEltYWdlXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHNlbGVjdG9ycy5wcmV2aWV3UG9wdXApO1xucG9wdXBJbWFnZS5jbG9zZSgpO1xuXG4vLyAvL3JlbmRlcmluZyBjYXJkXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlLCBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlLCBzZXRJc0xpa2VkKTtcblxuICAgIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuY29uc3QgaGFuZGxlSW1hZ2VDbGljayA9IChpbWFnZURhdGEpID0+IHtcbiAgICBwb3B1cEltYWdlLm9wZW4oaW1hZ2VEYXRhKVxufVxuXG5jb25zdCBzZXRJc0xpa2VkID0gKGNhcmQpID0+IHtcbiAgICBjYXJkLmlzTGlrZWQoKVxuICAgICAgICA/IGFwaS5kZWxldGVMaWtlKGNhcmQuZ2V0Q2FyZElkKCkpXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZC5zZXRJc0xpa2VkKGZhbHNlKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIDogYXBpLmFkZExpa2UoY2FyZC5nZXRDYXJkSWQoKSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICBjYXJkLnNldElzTGlrZWQodHJ1ZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICB9KVxufVxuXG4vL1VzZXJJbmZvXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhzZWxlY3RvcnMucHJvZmlsZVRpdGxlLCBzZWxlY3RvcnMucHJvZmlsZURlc2NyaXB0aW9uLCBzZWxlY3RvcnMucHJvZmlsZUF2YXRhcik7XG5cblxuUHJvbWlzZS5hbGwoW2FwaS5mZXRjaFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gICAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXG4gICAgICAgIH0pO1xuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXJJbWFnZSh1c2VyRGF0YS5hdmF0YXIpXG4gICAgICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgICAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcmRFbCA9IHJlbmRlckNhcmQoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdG9ycy5jYXJkc0xpc3RcbiAgICAgICAgKTtcbiAgICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuXG4vLyBBZGRpbmcgTmV3IENhcmQgRm9ybVxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuYWRkRm9ybVBvcHVwLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGZvcm1WYWxpZGF0b3JzW2FkZE5ld0NhcmRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgICBhZGRDYXJkRm9ybS5vcGVuKCk7XG59KVxuXG5jb25zdCBoYW5kbGVBZGRDYXJkU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgICBhZGRDYXJkRm9ybS5zaG93TG9hZGluZygpO1xuICAgIGNvbnN0IHsgbmFtZSwgbGluayB9ID0gZGF0YTtcbiAgICByZXR1cm4gYXBpLmFkZE5ld0NhcmQobmFtZSwgbGluaylcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhcmRFbCA9IHJlbmRlckNhcmQoZGF0YSk7XG4gICAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcbiAgICAgICAgICAgIGFkZENhcmRGb3JtLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGFkZENhcmRGb3JtLmhpZGVMb2FkaW5nKCk7XG4gICAgICAgIH0pO1xufVxuXG4vL0VkaXQgUHJvZmlsZSBGb3JtXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmVkaXRGb3JtUG9wdXAsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbmVkaXRQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGVzY3JpcHRpb247XG4gICAgZm9ybVZhbGlkYXRvcnNbcHJvZmlsZUVkaXRGb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXS5kaXNhYmxlQnV0dG9uKCk7XG4gICAgZWRpdFByb2ZpbGVNb2RhbC5vcGVuKCk7XG59KVxuXG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCA9ICh7IHRpdGxlLCBkZXNjcmlwdGlvbiB9KSA9PiB7XG4gICAgZWRpdFByb2ZpbGVNb2RhbC5zaG93TG9hZGluZygpO1xuICAgIHJldHVybiBhcGkuZWRpdFByb2ZpbGUodGl0bGUsIGRlc2NyaXB0aW9uKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IHRpdGxlLCBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfSk7XG4gICAgICAgICAgICBlZGl0UHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGVkaXRQcm9maWxlTW9kYWwuaGlkZUxvYWRpbmcoKTtcbiAgICAgICAgfSk7XG59XG5cbi8vQ2hhbmdpbmcgYXZhdGFyXG5cbmNvbnN0IHVwZGF0ZUF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmNoYW5nZUF2YXRhclBvcHVwLCBoYW5kbGVVcGRhdGVBdmF0YXIpO1xudXBkYXRlQXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaGFuZGxlVXBkYXRlQXZhdGFyID0gKHsgbGluayB9KSA9PiB7XG4gICAgdXBkYXRlQXZhdGFyTW9kYWwuc2hvd0xvYWRpbmcoKTtcbiAgICByZXR1cm4gYXBpLnVwZGF0ZUF2YXRhcihsaW5rKVxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UoZGF0YS5hdmF0YXIpO1xuICAgICAgICAgICAgdXBkYXRlQXZhdGFyTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgIHVwZGF0ZUF2YXRhck1vZGFsLnJlc2V0KCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIHVwZGF0ZUF2YXRhck1vZGFsLmhpZGVMb2FkaW5nKCk7XG4gICAgICAgIH0pXG59XG5cbnNlbGVjdG9ycy51cGRhdGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgZm9ybVZhbGlkYXRvcnNbc2VsZWN0b3JzLmF2YXRhckZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIHVwZGF0ZUF2YXRhck1vZGFsLm9wZW4oKTtcbn0pXG5cbi8vQ29uZmlybSBkZWxldGUgbW9kYWxcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzLm9rIFxuICAgICAgICAgICAgICAgICAgICA/IHJlcy5qc29uKClcbiAgICAgICAgICAgICAgICAgICAgOiBQcm9taXNlLnJlamVjdChcIkFuIGVycm9yIGhhcyBvY2N1cnJlZFwiLCByZXMuc3RhdHVzKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtyZXR1cm4gcmVzfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICAgICAgICB9KTtcblxuICAgIH1cbiAgICAgIFxuICAgIGZldGNoVXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJlcy5vayBcbiAgICAgICAgICAgICAgICA/IHJlcy5qc29uKClcbiAgICAgICAgICAgICAgICA6IFByb21pc2UucmVqZWN0KFwiQW4gZXJyb3IgaGFzIG9jY3VycmVkXCIsIHJlcy5zdGF0dXMpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtyZXR1cm4gcmVzfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgICB9KVxuXG4gICAgfVxuXG4gICAgZWRpdFByb2ZpbGUoeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSwgXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGFib3V0IFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGVkaXRQcm9maWxlQXZhdGFyKHsgbGluayB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogbGluayB9KSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgcmVzLm9rIFxuICAgICAgICAgICAgICAgID8gcmVzLmpzb24oKVxuICAgICAgICAgICAgICAgIDogUHJvbWlzZS5yZWplY3QoXCJBbiBlcnJvciBoYXMgb2NjdXJyZWRcIiwgcmVzLnN0YXR1cylcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge3JldHVybiByZXN9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoeyBjYXJkSWQgfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBhZGRMaWtlKHsgY2FyZElkIH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJlcy5vayBcbiAgICAgICAgICAgICAgICA/IHJlcy5qc29uKClcbiAgICAgICAgICAgICAgICA6IFByb21pc2UucmVqZWN0KFwiQW4gZXJyb3IgaGFzIG9jY3VycmVkXCIsIHJlcy5zdGF0dXMpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtyZXR1cm4gcmVzfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZWxldGVMaWtlKHsgY2FyZElkIH0pIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHJlcy5vayBcbiAgICAgICAgICAgICAgICA/IHJlcy5qc29uKClcbiAgICAgICAgICAgICAgICA6IFByb21pc2UucmVqZWN0KFwiQW4gZXJyb3IgaGFzIG9jY3VycmVkXCIsIHJlcy5zdGF0dXMpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtyZXR1cm4gcmVzfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgICB9KTtcbiAgICB9XG4gIH0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgICAgIHRoaXMuX21vZGFsTmFtZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fbmFtZScpO1xuICAgICAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpO1xuXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgb3BlbihpbWFnZURhdGEpIHtcbiAgICAgICAgdGhpcy5fbW9kYWxOYW1lLnRleHRDb250ZW50ID0gaW1hZ2VEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2UuYWx0ID0gaW1hZ2VEYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gaW1hZ2VEYXRhLmxpbms7XG5cbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IobmFtZUVsLCBkZXNjcmlwdGlvbkVsLCBhdmF0YXJFbCkge1xuICAgICAgICB0aGlzLl9uYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVFbCk7XG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uRWwpO1xuICAgICAgICB0aGlzLl9saW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJFbCk7XG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCxcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5fbGluay5zcmMsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbkVsLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gICAgfVxuXG4gICAgc2V0QXZhdGFySW1hZ2UobGluaykge1xuICAgICAgICB0aGlzLl9saW5rLnNyYyA9IGxpbms7XG4gICAgfVxufSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJvIiwib2JqIiwicHJvcCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInAiLCJiIiwiZG9jdW1lbnQiLCJiYXNlVVJJIiwic2VsZiIsImxvY2F0aW9uIiwiaHJlZiIsIlVSTCIsInNlbGVjdG9ycyIsImNhcmRzTGlzdCIsImNhcmRUZW1wbGF0ZSIsInByZXZpZXdQb3B1cCIsImVkaXRGb3JtUG9wdXAiLCJhZGRGb3JtUG9wdXAiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiZm9ybU1vZGFsQ29udGFpbmVyIiwiaW1hZ2VNb2RhbENvbnRhaW5lciIsImZvcm1JbnB1dE5hbWUiLCJmb3JtSW5wdXREZXNjcmlwdGlvbiIsImNoYW5nZUF2YXRhclBvcHVwIiwiYXZhdGFyRm9ybSIsInVwZGF0ZUF2YXRhckJ1dHRvbiIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGUiLCJjYXJkU2VsZWN0b3IiLCJzZXRJc0xpa2VkIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkSWQiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX3NldElzTGlrZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsIl9lbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaW1hZ2VNb2RhbCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlTGlrZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImRlbGV0ZUNhcmQiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkSW1hZ2UiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImdldENhcmRJZCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbGVtZW50cyIsImV2ZXJ5IiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfY2xvc2VCdXR0b24iLCJzZXRFdmVudExpc3RlbmVycyIsImV2dCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInN1cGVyIiwiX2Zvcm0iLCJfZm9ybUlucHV0cyIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2J1dHRvblRleHQiLCJfbG9hZGluZ1RleHQiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRPYmplY3QiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJhZGROZXdDYXJkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0Iiwic2VjdGlvbiIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZldGNoVXNlckluZm8iLCJlZGl0UHJvZmlsZSIsIl9yZWYyIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRQcm9maWxlQXZhdGFyIiwiX3JlZjMiLCJhdmF0YXIiLCJhZGROZXdDYXJkIiwiX3JlZjQiLCJfcmVmNSIsImNhcmRJZCIsImFkZExpa2UiLCJfcmVmNiIsImRlbGV0ZUxpa2UiLCJfcmVmNyIsImF1dGhvcml6YXRpb24iLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1WYWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJwb3B1cEltYWdlIiwiX21vZGFsTmFtZSIsIl9tb2RhbEltYWdlIiwiaW1hZ2VEYXRhIiwicmVuZGVyQ2FyZCIsIkNhcmQiLCJjYXJkIiwidXNlckluZm8iLCJuYW1lRWwiLCJkZXNjcmlwdGlvbkVsIiwiYXZhdGFyRWwiLCJfbmFtZUVsIiwiX2Rlc2NyaXB0aW9uRWwiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXJJbWFnZSIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHMiLCJjYXJkRWwiLCJjYXJkU2VjdGlvbiIsImxvZyIsImFkZENhcmRGb3JtIiwiaGFuZGxlQWRkQ2FyZFN1Ym1pdCIsImZpbmFsbHkiLCJlZGl0UHJvZmlsZU1vZGFsIiwiaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQiLCJ0aXRsZSIsInVwZGF0ZUF2YXRhck1vZGFsIiwiaGFuZGxlVXBkYXRlQXZhdGFyIiwidXBkYXRlQXZhdGFyIl0sInNvdXJjZVJvb3QiOiIifQ==